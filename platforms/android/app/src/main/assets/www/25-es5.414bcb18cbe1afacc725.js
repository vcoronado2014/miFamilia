function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"1VCC":function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var r=o("fXoL"),a=o("TEn/"),i=function(){var t=function(){function t(){_classCallCheck(this,t),this.mostrar=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Kb({type:t,selectors:[["app-progress"]],inputs:{mostrar:"mostrar",titulo:"titulo"},decls:4,vars:2,consts:[[1,"centrado",3,"hidden"],[1,"titulo-item-2"],["type","indeterminate",1,"ion-margin-top"]],template:function(t,e){1&t&&(r.Vb(0,"div",0),r.Vb(1,"ion-label",1),r.zc(2),r.Ub(),r.Rb(3,"ion-progress-bar",2),r.Ub()),2&t&&(r.jc("hidden",!e.mostrar),r.Cb(2),r.Ac(e.titulo))},directives:[a.A,a.G],styles:[".centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}"]}),t}()},TPni:function(t,e,o){"use strict";o.r(e),o.d(e,"ContactabilidadPageModule",(function(){return U}));var r=o("ofXK"),a=o("3Pt+"),i=o("TEn/"),s=o("tyNb"),n=o("kmnG"),c=o("d3UM"),l=o("qFsG"),u=o("bTqV"),m=o("NFeN"),d=o("mrSG"),p=o("wd/R"),g=o("fXoL"),b=o("ymXj"),h=o("w9zE"),f=o("Li8n"),C=o("skLv"),v=o("1VCC");function R(t,e){if(1&t&&g.Rb(0,"img",20),2&t){var o=g.gc();g.kc("src",o.usuarioAps.UrlImagen,g.sc)}}function A(t,e){1&t&&g.Rb(0,"img",21)}var I,S,O=((I=function(){function t(e,o,r,a,i,s,n,c,l,u){_classCallCheck(this,t),this.navCtrl=e,this.utiles=o,this.servicioGeo=r,this.loading=a,this.formBuilder=i,this.activatedRoute=s,this.router=n,this.acceso=c,this.parametrosApp=l,this.alertController=u,this.patternOnlyLetter="[a-zA-Z\xc0-\xff\xf1\xd1]+(s*[a-zA-Z\xc0-\xff\xf1\xd1]*)*[a-zA-Z\xc0-\xff\xf1\xd1 ]+$",this.expCelular=/^(\+?56)?(\s?)(0?9)(\s?)[9876543]\d{7}$/gm,this.expPassword=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{4,8}$/gm,this.expEmail=/^[^@\s]+@[^@\s]+\.[^@\s]+$/gm,this.registro=null,this.estaCargando=!1,this.tituloProgress="",this.usuarioAps=null,this.usuarioApsRegistro=null,this.modificaRegistro=!1,this.nombrePersona=""}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;p.locale("es"),this.activatedRoute.queryParams.subscribe((function(e){e&&e.usuario&&(localStorage.getItem("REGISTRO")&&(t.registro=JSON.parse(localStorage.getItem("REGISTRO"))),t.usuarioAps=JSON.parse(e.usuario),t.nombrePersona=t.usuarioAps.Nombres+" "+t.usuarioAps.ApellidoPaterno,localStorage.getItem("UsuarioAps")&&(t.usuarioApsRegistro=JSON.parse(localStorage.getItem("UsuarioAps"))),t.usuarioAps&&t.usuarioApsRegistro&&t.registro&&t.usuarioAps.Id==t.usuarioApsRegistro.Id&&(t.modificaRegistro=!0))})),this.cargarForma()}},{key:"cargarForma",value:function(){this.forma=new a.e({nombreSocial:new a.c(""),email:new a.c("",[a.q.pattern(this.expEmail)]),telefono:new a.c("",[a.q.pattern(this.expCelular)])}),this.modificaRegistro?this.registro&&null!=this.registro&&this.forma.setValue({nombreSocial:this.registro.Apodo,email:this.registro.CorreoElectronico,telefono:this.registro.TelefonoContacto?this.registro.TelefonoContacto:""}):null!=this.usuarioAps.Contactabilidad&&this.forma.setValue({nombreSocial:this.usuarioAps.Contactabilidad.NombreSocial,email:this.usuarioAps.Contactabilidad.Email,telefono:this.usuarioAps.Contactabilidad.Telefono?this.usuarioAps.Contactabilidad.Telefono:""})}},{key:"onSumbit",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,o,r,a,i,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.parametrosApp.USA_API_MANAGEMENT()){t.next=10;break}return t.next=3,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null,duration:2e3});case 3:return e=t.sent,this.estaCargando=!0,this.tituloProgress="Actualizando datos de contacto",o=this.forma.controls.email?this.forma.controls.email.value:"",r=this.forma.controls.nombreSocial?this.forma.controls.nombreSocial.value:"",a=this.forma.controls.telefono?this.forma.controls.telefono.value:"",i=this.usuarioAps.Rut,t.next=8,e.present().then((function(){return Object(d.b)(s,void 0,void 0,regeneratorRuntime.mark((function t(){var s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.postInformarPersonaNative(i,r,o,a,"MOVIL_FICHA_FAMILIAR").then((function(t){var n=JSON.parse(t.data);s.procesarRespuesta(n,e,r,a,o,i)})).catch((function(t){console.log(t.message),s.estaCargando=!1,e.dismiss(),s.tituloProgress="",s.utiles.presentToast("Se present\xf3 un error al guardar los datos, contacte al administrador","bottom",2e3)})):this.servicioGeo.postInformarPersona(i,r,o,a,"MOVIL_FICHA_FAMILIAR").subscribe((function(t){s.procesarRespuesta(t,e,r,a,o,i)}),(function(t){console.log(t.message),s.estaCargando=!1,e.dismiss(),s.tituloProgress="",s.utiles.presentToast("Se present\xf3 un error al guardar los datos, contacte al administrador","bottom",2e3)}));case 1:case"end":return t.stop()}}),t,this)})))}));case 8:t.next=11;break;case 10:this.utiles.presentToast("Esta funcionalidad no est\xe1 disponible","bottom",3e3);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"procesarRespuesta",value:function(t,e,o,r,a,i){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t?t.InformarPersonaResponse&&t.InformarPersonaResponse.RespuestaBase?(s=!1,n=!1,t.InformarPersonaResponse.RespuestaBase.Rayen&&"TRANSACCI\xd3N EXITOSA"==t.InformarPersonaResponse.RespuestaBase.Rayen.Descripcion.toUpperCase()&&(s=!0),t.InformarPersonaResponse.RespuestaBase.Ryf&&"TRANSACCI\xd3N EXITOSA"==t.InformarPersonaResponse.RespuestaBase.Ryf.Descripcion.toUpperCase()&&(n=!0),n||s?(this.estaCargando=!1,this.tituloProgress="",e.dismiss(),this.utiles.presentToast("Datos actualizados correctamente","bottom",2e3),this.modificaRegistro&&this.actualizarRegistro(o,r),this.obtenerContactabilidad(i)):(this.estaCargando=!1,e.dismiss(),this.tituloProgress="",this.utiles.presentToast("Error al actualizar los datos","bottom",2e3))):(this.estaCargando=!1,e.dismiss(),this.tituloProgress="",this.utiles.presentToast("Error al actualizar los datos","bottom",3e3)):(this.estaCargando=!1,e.dismiss(),this.utiles.presentToast("Error al actualizar los datos","bottom",3e3),this.tituloProgress="");case 1:case"end":return a.stop()}}),a,this)})))}},{key:"actualizarRegistro",value:function(t,e){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function o(){var r,a,i=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=p(),this.registro.FechaNacimiento&&(r=p(this.registro.FechaNacimiento)),this.registro.Apodo=t,this.registro.TelefonoContacto=e,this.registro.Id=this.registro.Id.toString(),this.registro.Activo=this.registro.Activo.toString(),this.registro.DiaNacimiento=r.date().toString(),this.registro.MesNacimiento=(r.month()+1).toString(),this.registro.AnioNacimiento=r.year().toString(),this.registro.Eliminado=this.registro.Eliminado.toString(),this.registro.ModoRegistro=this.registro.ModoRegistro.toString(),this.registro.FechaBaja=null,o.next=4,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});case 4:return a=o.sent,this.estaCargando=!0,this.tituloProgress="Actualizando datos de registro",o.next=9,a.present().then((function(){return Object(d.b)(i,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.postRegistroFamiliaNative(this.registro).then((function(t){var o=JSON.parse(t.data);localStorage.setItem("REGISTRO",JSON.stringify(o)),a.dismiss(),e.estaCargando=!1,e.utiles.presentToast("Datos actualizados correctamente","bottom",2e3)})).catch((function(t){a.dismiss(),e.estaCargando=!1,e.utiles.presentToast(t,"bottom",2e3)})):this.servicioGeo.postRegistroFamilia(this.registro).subscribe((function(t){localStorage.setItem("REGISTRO",JSON.stringify(t)),a.dismiss(),e.estaCargando=!1,e.utiles.presentToast("Datos actualizados correctamente","bottom",2e3)}),(function(t){a.dismiss(),e.estaCargando=!1,e.utiles.presentToast(t,"bottom",2e3)}));case 1:case"end":return t.stop()}}),t,this)})))}));case 9:case"end":return o.stop()}}),o,this)})))}},{key:"actualizarContactabilidad",value:function(t,e,o,r){var a={Rut:t.Rut,Id:t.Id,NombreSocial:e,Telefono:o,Email:r,EtiquetaTelefono:"MOVIL_FICHA_FAMILIAR"};if(localStorage.getItem("UsuarioAps")){var i=JSON.parse(localStorage.getItem("UsuarioAps"));i&&i.Id==t.Id&&(i.Contactabilidad=a,localStorage.setItem("UsuarioAps",JSON.stringify(i)))}if(localStorage.getItem("UsuariosFamilia")){var s=!1,n=JSON.parse(localStorage.getItem("UsuariosFamilia"));if(n&&n.length>0)for(var c=0;c<n.length;c++)n[c].Id==t.Id&&(n[c].Contactabilidad=a,s=!0);s&&localStorage.setItem("UsuariosFamilia",JSON.stringify(n))}}},{key:"obtenerContactabilidad",value:function(t){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});case 2:return o=e.sent,this.estaCargando=!0,this.tituloProgress="Buscando contactabilidad",e.next=7,o.present().then((function(){return Object(d.b)(r,void 0,void 0,regeneratorRuntime.mark((function e(){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.getContactabilidadNative(t).then((function(t){var e=JSON.parse(t.data);o.dismiss(),r.estaCargando=!1,r.utiles.actualizarContactabilidad(e)})).catch((function(t){o.dismiss(),r.estaCargando=!1,r.utiles.presentToast(t,"bottom",2e3)})):this.servicioGeo.getContactabilidad(t).subscribe((function(t){var e=t;o.dismiss(),r.estaCargando=!1,r.utiles.actualizarContactabilidad(e)}),(function(t){o.dismiss(),r.estaCargando=!1,r.utiles.presentToast(t,"bottom",2e3)}));case 1:case"end":return e.stop()}}),e,this)})))}));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"f",get:function(){return this.forma.controls}}]),t}()).\u0275fac=function(t){return new(t||I)(g.Qb(i.Z),g.Qb(b.a),g.Qb(h.a),g.Qb(i.W),g.Qb(a.b),g.Qb(s.a),g.Qb(s.g),g.Qb(f.a),g.Qb(C.a),g.Qb(i.a))},I.\u0275cmp=g.Kb({type:I,selectors:[["app-contactabilidad"]],decls:40,vars:9,consts:[[1,"back-app"],["color","primary","mode","md"],["slot","start"],["defaultHref","/familia",1,"fcw"],[1,"fcw"],[3,"mostrar","titulo"],[1,"ion-padding",2,"margin-top","15px",3,"hidden"],["novalidate","",3,"formGroup"],["lines","none",2,"--ion-item-background","transparent","--padding-start","0px"],["slot","start",2,"margin-top","-10px"],[3,"src",4,"ngIf"],["src","../assets/img/no-imagen.jpg",4,"ngIf"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Nombre social","formControlName","nombreSocial","name","nombreSocial"],["align","start"],[1,"mt-40"],["matInput","","placeholder","ejemplo@gmail.com","formControlName","email","name","email"],[3,"hidden"],["matInput","","placeholder","9XXXXXXXX","formControlName","telefono","name","telefono"],["mat-raised-button","","color","accent",1,"button-registrarse",3,"disabled","click"],[3,"src"],["src","../assets/img/no-imagen.jpg"]],template:function(t,e){1&t&&(g.Vb(0,"ion-header",0),g.Vb(1,"ion-toolbar",1),g.Vb(2,"ion-buttons",2),g.Rb(3,"ion-back-button",3),g.Ub(),g.Vb(4,"ion-title",4),g.zc(5,"Configurar integrante"),g.Ub(),g.Ub(),g.Ub(),g.Vb(6,"ion-content"),g.Rb(7,"app-progress",5),g.Vb(8,"div",6),g.Vb(9,"form",7),g.Vb(10,"ion-item",8),g.Vb(11,"ion-avatar",9),g.yc(12,R,1,1,"img",10),g.yc(13,A,1,0,"img",11),g.Ub(),g.Vb(14,"mat-form-field",12),g.Vb(15,"mat-label"),g.zc(16,"Nombre social"),g.Ub(),g.Rb(17,"input",13),g.Vb(18,"mat-hint",14),g.Vb(19,"strong"),g.zc(20,"Nombre por el cual te sientes identificado"),g.Ub(),g.Ub(),g.Ub(),g.Ub(),g.Vb(21,"h3",15),g.zc(22,"Datos de contacto"),g.Ub(),g.Vb(23,"ion-row"),g.Vb(24,"mat-form-field",12),g.Vb(25,"mat-label"),g.zc(26,"Correo electr\xf3nico"),g.Ub(),g.Rb(27,"input",16),g.Vb(28,"mat-error",17),g.zc(29,"Correo inv\xe1lido"),g.Ub(),g.Ub(),g.Ub(),g.Vb(30,"ion-row"),g.Vb(31,"mat-form-field",12),g.Vb(32,"mat-label"),g.zc(33,"Tel\xe9fono"),g.Ub(),g.Rb(34,"input",18),g.Vb(35,"mat-error",17),g.zc(36,"Tel\xe9fono inv\xe1lido"),g.Ub(),g.Ub(),g.Ub(),g.Vb(37,"ion-row"),g.Vb(38,"button",19),g.dc("click",(function(){return e.onSumbit()})),g.zc(39,"GUARDAR"),g.Ub(),g.Ub(),g.Ub(),g.Ub(),g.Ub()),2&t&&(g.Cb(7),g.jc("mostrar",e.estaCargando)("titulo",e.tituloProgress),g.Cb(1),g.jc("hidden",e.estaCargando),g.Cb(1),g.jc("formGroup",e.forma),g.Cb(3),g.jc("ngIf",""!=e.usuarioAps.UrlImagen),g.Cb(1),g.jc("ngIf",""==e.usuarioAps.UrlImagen),g.Cb(15),g.jc("hidden",!(e.f.email.errors&&e.f.email.errors.pattern)),g.Cb(7),g.jc("hidden",!(e.f.telefono.errors&&e.f.telefono.errors.pattern)),g.Cb(3),g.jc("disabled",e.forma.invalid))},directives:[i.u,i.T,i.i,i.e,i.f,i.R,i.p,v.a,a.r,a.l,a.f,i.z,i.d,r.k,n.c,n.g,l.b,a.a,a.k,a.d,n.f,i.K,n.b,u.b],styles:[".mt-32[_ngcontent-%COMP%]{margin-top:32px}.mt-24[_ngcontent-%COMP%]{margin-top:24px}.mt-80[_ngcontent-%COMP%]{margin-top:5em}.mt-40[_ngcontent-%COMP%]{margin-top:2.5em}.mt-36[_ngcontent-%COMP%]{margin-top:2.25em}.mt-52[_ngcontent-%COMP%]{margin-top:3.25em}.texto-1[_ngcontent-%COMP%]{font-size:1em;color:rgba(0,0,0,.87)}.button-registrarse[_ngcontent-%COMP%]{width:80%;margin-left:10%}"]}),I),w=o("j1ZV"),U=((S=function t(){_classCallCheck(this,t)}).\u0275mod=g.Ob({type:S}),S.\u0275inj=g.Nb({factory:function(t){return new(t||S)},imports:[[r.c,a.g,a.o,i.U,n.e,c.b,l.c,u.c,m.b,w.a,s.j.forChild([{path:"",component:O}])]]}),S)}}]);