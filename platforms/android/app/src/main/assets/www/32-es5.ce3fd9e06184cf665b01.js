function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var o=i[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"1VCC":function(t,i,e){"use strict";e.d(i,"a",(function(){return s}));var o=e("fXoL"),n=e("TEn/"),s=function(){var t=function(){function t(){_classCallCheck(this,t),this.mostrar=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["app-progress"]],inputs:{mostrar:"mostrar",titulo:"titulo"},decls:4,vars:2,consts:[[1,"centrado",3,"hidden"],[1,"titulo-item-2"],["type","indeterminate",1,"ion-margin-top"]],template:function(t,i){1&t&&(o.Vb(0,"div",0),o.Vb(1,"ion-label",1),o.zc(2),o.Ub(),o.Rb(3,"ion-progress-bar",2),o.Ub()),2&t&&(o.jc("hidden",!i.mostrar),o.Cb(2),o.Ac(i.titulo))},directives:[n.A,n.G],styles:[".centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}"]}),t}()},grgm:function(t,i,e){"use strict";e.r(i),e.d(i,"PreTiposatencionPageModule",(function(){return w}));var o=e("ofXK"),n=e("3Pt+"),s=e("TEn/"),a=e("tyNb"),r=e("mrSG"),c=e("wd/R"),d=e("hxmY"),p=e("/Lwr"),l=e("fXoL"),u=e("ymXj"),h=e("Li8n"),b=e("MTKf"),g=e("skLv"),m=e("kmnG"),f=e("d3UM"),v=e("1VCC"),C=e("FKr1");function x(t,i){if(1&t&&(l.Vb(0,"mat-option",12),l.zc(1),l.Ub()),2&t){var e=i.$implicit;l.jc("value",e.Texto),l.Cb(1),l.Ac(e.Texto)}}function A(t,i){if(1&t){var e=l.Wb();l.Vb(0,"ion-row",24),l.dc("click",(function(){l.rc(e);var t=l.gc().$implicit;return l.gc(2).citaSelected(t)})),l.Vb(1,"ion-col",25),l.zc(2),l.Ub(),l.Vb(3,"ion-col",26),l.zc(4),l.Ub(),l.Vb(5,"ion-col",27),l.zc(6),l.Ub(),l.Vb(7,"ion-col",28),l.zc(8),l.Ub(),l.Ub()}if(2&t){var o=l.gc().$implicit,n=l.gc(2);l.Cb(2),l.Bc(" ",o.Servicio.Nombre," "),l.Cb(2),l.Bc(" ",n.transformDateIso(o.FechaHoraInicio)," "),l.Cb(2),l.Bc(" ",n.transformDate(o.FechaHoraInicio,"dddd DD MMMM YYYY")," "),l.Cb(2),l.Cc(" ",o.NombresMedico.toLowerCase()," ",o.ApellidosMedico.toLowerCase()," ")}}function O(t,i){if(1&t&&(l.Vb(0,"ion-grid",22),l.yc(1,A,9,5,"ion-row",23),l.Ub()),2&t){var e=i.$implicit;l.Cb(1),l.jc("ngIf",e.indice<=3)}}function I(t,i){if(1&t){var e=l.Wb();l.Vb(0,"div"),l.Vb(1,"div",13),l.Vb(2,"h6",14),l.zc(3," Citas m\xe1s pr\xf3ximas "),l.Ub(),l.Vb(4,"p",15),l.zc(5," A continuaci\xf3n se listan los cupos disponibles m\xe1s pr\xf3ximos. "),l.Ub(),l.Ub(),l.Vb(6,"div",16),l.yc(7,O,2,1,"ion-grid",17),l.Ub(),l.Vb(8,"div",18),l.Vb(9,"p",19),l.zc(10," Si no te sirven los cupos propuesto prueba con la b\xfasqueda avanzada. "),l.Ub(),l.Ub(),l.Vb(11,"div",20),l.Vb(12,"ion-button",21),l.dc("click",(function(){return l.rc(e),l.gc().openBusquedaAvanzada()})),l.zc(13,"B\xdaSQUEDA AVANZADA"),l.Ub(),l.Ub(),l.Ub()}if(2&t){var o=l.gc();l.Cb(7),l.jc("ngForOf",o.citasFiltradas)}}function P(t,i){1&t&&(l.Vb(0,"div",29),l.Vb(1,"ion-label",30),l.zc(2,"No existen cupos con los criterios ingresados"),l.Ub(),l.Ub())}var T,k,S=((T=function(){function t(i,e,o,n,s,a,r,c,d,p,l,u){_classCallCheck(this,t),this.navCtrl=i,this.toast=e,this.modalCtrl=o,this.platform=n,this.loading=s,this.menu=a,this.utiles=r,this.acceso=c,this.cita=d,this.parametrosApp=p,this.activatedRoute=l,this.router=u,this.miColor="#FF4081",this.textColor="#FFFFFF",this.runPaciente="",this.codigoDeis="",this.serviceType="349",this.tipoOperacion="disponibilidad",this.citas=[],this.citasFiltradas=[],this.tiposAtencion=[],this.comboSeleccionado="Selecciona...",this.idComboSeleccionado=0,this.mostrarProgress=!1,this.encontroCitas=!1,this.disabledCombo=!1,this.paginaActual=0,this.mostrarProgressDisp=!1,this.encontroCitasDisp=!1,this.idConsultar=0}return _createClass(t,[{key:"ngOnInit",value:function(){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.locale("es"),this.activatedRoute.queryParams.subscribe((function(t){return Object(r.b)(i,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t||!t.Id){i.next=23;break}if(this.idConsultar=t.Id,this.usuarioAps=this.utiles.entregaUsuario(t.Id),null==this.usuarioAps){i.next=20;break}if(this.usuarioAps.UrlImagen=this.utiles.entregaImagen(this.usuarioAps),this.miColor=this.utiles.entregaColor(this.usuarioAps),this.runPaciente=this.utiles.insertarGuion(this.usuarioAps.Rut),this.codigoDeis=this.usuarioAps.ConfiguracionNodo.CodigoDeis2014,this.nodId=this.usuarioAps.ConfiguracionNodo.NodId,this.crearTiposAtencion(),this.setFechasInicioFin(),!this.parametrosApp.USA_API_MANAGEMENT()){i.next=16;break}return i.next=14,this.buscarDisponibilidadApi(this.fechaInicio,this.fechaTermino,this.codigoDeis,this.runPaciente,this.serviceType,this.tipoOperacion);case 14:i.next=18;break;case 16:return i.next=18,this.buscarDisponibilidad(this.fechaInicio,this.fechaTermino,this.codigoDeis,this.runPaciente,this.serviceType,this.tipoOperacion);case 18:i.next=21;break;case 20:this.utiles.presentToast("No hay usuario, vuelva a seleccionar","bottom",2e3);case 21:i.next=24;break;case 23:this.utiles.presentToast("No hay usuario, vuelva a seleccionar","bottom",2e3);case 24:case"end":return i.stop()}}),i,this)})))}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setFechasInicioFin",value:function(){var t=c().add(this.parametrosApp.HORAS_FECHA_INICIO(),"hour"),i=new Date;console.log(t),i=new Date(t.year(),t.month(),t.date(),0,0,0,0),console.log(i);var e=c().add(1,"month"),o=new Date(e.year(),e.month(),e.date(),23,59,0,0);console.log(e),console.log(o),this.fechaInicio=t.format(),this.fechaTermino=e.format(),sessionStorage.setItem("FECHA_INICIO_CONSULTA",this.fechaInicio),sessionStorage.setItem("FECHA_TERMINO_CONSULTA",this.fechaTermino)}},{key:"buscarDisponibilidad",value:function(t,i,e,o,n,s){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var c,d=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});case 2:return c=a.sent,a.next=5,c.present().then((function(){return Object(r.b)(d,void 0,void 0,regeneratorRuntime.mark((function a(){var r=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:this.disabledCombo=!0,this.mostrarProgress=!0,this.citas=[],this.citasFiltradas=[],this.utiles.isAppOnDevice()?this.cita.getDisponibilidadNative(t,i,e,o,n,"","",s,this.nodId).then((function(t){var i=JSON.parse(t.data);r.procesarRespuestaTotal(i,c)})):this.cita.getDisponibilidad(t,i,e,o,n,"","",s,this.nodId).subscribe((function(t){r.procesarRespuestaTotal(t,c)}));case 1:case"end":return a.stop()}}),a,this)})))}));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"buscarDisponibilidadApi",value:function(t,i,e,o,n,s){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function a(){var c,d=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});case 2:return c=a.sent,a.next=5,c.present().then((function(){return Object(r.b)(d,void 0,void 0,regeneratorRuntime.mark((function a(){var r=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:this.disabledCombo=!0,this.mostrarProgressDisp=!0,this.citas=[],this.citasFiltradas=[],this.utiles.isAppOnDevice()?this.cita.getDisponibilidadApiNative(t,i,e,o,n,"","",s,this.nodId).then((function(t){var i=JSON.parse(t.data);r.procesarRespuestaTotal(i,c)})).catch((function(t){console.log(t.message),c.dismiss(),r.disabledCombo=!1,r.mostrarProgressDisp=!1,r.utiles.presentToast("Se ha producido un error al obtener disponibilidad","bottom",2e3)})):this.cita.getDisponibilidadApi(t,i,e,o,n,"","",s,this.nodId).subscribe((function(t){r.procesarRespuestaTotal(t,c)}),(function(t){console.log(t.message),c.dismiss(),r.disabledCombo=!1,r.mostrarProgressDisp=!1,r.utiles.presentToast("Se ha producido un error al obtener disponibilidad","bottom",2e3)}));case 1:case"end":return a.stop()}}),a,this)})))}));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"procesarRespuestaTotalDisp",value:function(t){this.citas=[],this.citasFiltradas=[],t&&t.Mensaje&&("correcto"==t.Mensaje.Codigo?(t.TiposAtencion&&this.agregarTiposAtencion(t.TiposAtencion),this.citas=t.CitasDisponibles,sessionStorage.setItem("CITAS_DISPONIBLES",JSON.stringify(this.citas))):(this.idComboSeleccionado=0,this.tiposAtencion=[],this.citas=[],this.citasFiltradas=[]),this.mostrarProgressDisp=!1,this.encontroCitasDisp=!0)}},{key:"procesarRespuestaTotal",value:function(t,i){this.citas=[],this.citasFiltradas=[],t&&t.Mensaje&&("correcto"==t.Mensaje.Codigo?(t.TiposAtencion&&this.agregarTiposAtencion(t.TiposAtencion),this.citas=t.CitasDisponibles,sessionStorage.setItem("CITAS_DISPONIBLES",JSON.stringify(this.citas)),i.dismiss(),this.disabledCombo=!1,this.mostrarProgressDisp=!1,this.mostrarProgress=!1):(this.idComboSeleccionado=0,this.tiposAtencion=[],this.citas=[],this.citasFiltradas=[],i.dismiss(),this.disabledCombo=!1,this.mostrarProgressDisp=!1,this.mostrarProgress=!1))}},{key:"indexarCitas",value:function(){var t=this;this.citasFiltradas=[];var i=1;this.citas&&this.citas.length>0&&this.citas.forEach((function(e){e.TipoAtencion==t.comboSeleccionado&&(e.indice=i,t.citasFiltradas.push(e),i++)})),i>2&&(this.encontroCitas=!0)}},{key:"crearTiposAtencion",value:function(){this.tiposAtencion=[],this.tiposAtencion.push({Texto:"Selecciona...",Valor:0,Selected:!0}),this.idComboSeleccionado=0}},{key:"agregarTiposAtencion",value:function(t){var i=this,e=1;t&&t.length>0&&t.forEach((function(t){i.tiposAtencion.push({Texto:t,Valor:e,Selected:!1}),e++})),sessionStorage.setItem("TIPOS_ATENCION",JSON.stringify(this.tiposAtencion))}},{key:"seleccionarItemCombo",value:function(){var t=this;this.comboSeleccionado&&this.tiposAtencion&&(this.tiposAtencion.forEach((function(i){i.Selected=i.Texto==t.comboSeleccionado})),sessionStorage.setItem("TIPOS_ATENCION",JSON.stringify(this.tiposAtencion)))}},{key:"buscarCitas",value:function(t){var i=this;t.value&&(this.comboSeleccionado=t.value,this.mostrarProgress=!0,this.encontroCitas=!1,this.disabledCombo=!1,this.seleccionarItemCombo(),setTimeout((function(){i.mostrarProgress=!1,i.disabledCombo=!0,i.indexarCitas()}),2e3))}},{key:"transformDate",value:function(t,i){return(new d.a).transform(t,i)}},{key:"transformDateIso",value:function(t){var i="",e=t.split("T");if(e&&2==e.length){var o=e[1].split(":");o&&o.length>1&&(i=o[0]+":"+o[1])}return i}},{key:"citaSelected",value:function(t){return Object(r.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var e,o=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t&&(this.itemSelected=t),i.next=3,this.modalCtrl.create({component:p.a,componentProps:{cita:JSON.stringify(t),operacion:"reservar"}});case 3:return(e=i.sent).onDidDismiss().then((function(t){t.data&&t.data.accion&&o.navCtrl.navigateRoot("calendario")})),i.next=7,e.present();case 7:return i.abrupt("return",i.sent);case 8:case"end":return i.stop()}}),i,this)})))}},{key:"openBusquedaAvanzada",value:function(){this.navCtrl.navigateRoot(["busqueda-avanzada"],{queryParams:{Id:this.idConsultar}})}}]),t}()).\u0275fac=function(t){return new(t||T)(l.Qb(s.Z),l.Qb(s.gb),l.Qb(s.Y),l.Qb(s.bb),l.Qb(s.W),l.Qb(s.X),l.Qb(u.a),l.Qb(h.a),l.Qb(b.a),l.Qb(g.a),l.Qb(a.a),l.Qb(a.g))},T.\u0275cmp=l.Kb({type:T,selectors:[["app-pre-tiposatencion"]],decls:16,vars:7,consts:[["color","primary","mode","md"],["slot","start"],["defaultHref","/calendario",1,"fcw"],[1,"fcw"],[1,"back-app"],["appearance","outline",1,"field-tipo-atencion"],[3,"disabled","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["titulo","Buscando citas",3,"mostrar"],["titulo","Buscando tipos atenci\xf3n",3,"mostrar"],[4,"ngIf"],["class","ion-padding-start ion-padding-end centrado",4,"ngIf"],[3,"value"],[1,"ion-padding-start","ion-padding-end"],[1,"titulo-item"],[1,"ion-text-wrap","texto-item"],[1,"ion-padding"],["class","ion-no-padding",4,"ngFor","ngForOf"],[1,"pl-24","pr-24"],[1,"ion-text-wrap","texto-item","ion-text-left"],[1,"ion-padding-top"],["expand","full","fill","clear",3,"click"],[1,"ion-no-padding"],["class","ion-padding-bottom ion-padding-top linea-item",3,"click",4,"ngIf"],[1,"ion-padding-bottom","ion-padding-top","linea-item",3,"click"],["size","9",1,"texto-item","ion-text-capitalize"],["size","3",1,"titulo-hora","ion-text-end"],["size","12",1,"ion-text-capitalize"],[1,"texto-item","ion-text-capitalize"],[1,"ion-padding-start","ion-padding-end","centrado"],[1,"ion-text-center","no-encontrado"]],template:function(t,i){1&t&&(l.Vb(0,"ion-header"),l.Vb(1,"ion-toolbar",0),l.Vb(2,"ion-buttons",1),l.Rb(3,"ion-back-button",2),l.Ub(),l.Vb(4,"ion-title",3),l.zc(5,"Reserva de horas"),l.Ub(),l.Ub(),l.Ub(),l.Vb(6,"ion-content",4),l.Vb(7,"mat-form-field",5),l.Vb(8,"mat-label"),l.zc(9,"Tipo atenci\xf3n"),l.Ub(),l.Vb(10,"mat-select",6),l.dc("ngModelChange",(function(t){return i.comboSeleccionado=t}))("selectionChange",(function(t){return i.buscarCitas(t)})),l.yc(11,x,2,2,"mat-option",7),l.Ub(),l.Ub(),l.Rb(12,"app-progress",8),l.Rb(13,"app-progress",9),l.yc(14,I,14,1,"div",10),l.yc(15,P,3,0,"div",11),l.Ub()),2&t&&(l.Cb(10),l.jc("disabled",i.disabledCombo)("ngModel",i.comboSeleccionado),l.Cb(1),l.jc("ngForOf",i.tiposAtencion),l.Cb(1),l.jc("mostrar",i.mostrarProgress),l.Cb(1),l.jc("mostrar",i.mostrarProgressDisp),l.Cb(1),l.jc("ngIf",i.encontroCitas),l.Cb(1),l.jc("ngIf",!i.encontroCitas&&0==i.mostrarProgress&&i.citasFiltradas.length>0))},directives:[s.u,s.T,s.i,s.e,s.f,s.R,s.p,m.c,m.g,f.a,n.k,n.n,o.j,v.a,o.k,C.j,s.h,s.t,s.K,s.o,s.A],styles:[".combo[_ngcontent-%COMP%]{width:100%;max-width:100%}.centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item[_ngcontent-%COMP%]{font-size:14px;color:rgba(0,0,0,.87);font-weight:700}.titulo-fecha[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}.titulo-hora[_ngcontent-%COMP%]{font-size:12px;color:rgba(0,0,0,.87)}.no-encontrado[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.54)}.pt-8[_ngcontent-%COMP%]{padding-top:8px}.pb-8[_ngcontent-%COMP%]{padding-bottom:8px}.pl-24[_ngcontent-%COMP%]{padding-left:24px}.pr-24[_ngcontent-%COMP%]{padding-right:24px}.linea-item[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12)}.borde[_ngcontent-%COMP%]{border-radius:5px;border:1px solid rgba(0,0,0,.12);padding:0 5px 5px}.label-tda[_ngcontent-%COMP%]{position:relative;top:-10px;margin-left:16px;padding-left:2px;padding-right:5px;background:#fff}.pt-32[_ngcontent-%COMP%]{padding-top:32px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}.centradoDisp[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:35%;padding-left:60px;padding-right:60px}"]}),T),y=e("j1ZV"),w=((k=function t(){_classCallCheck(this,t)}).\u0275mod=l.Ob({type:k}),k.\u0275inj=l.Nb({factory:function(t){return new(t||k)},imports:[[o.c,n.g,s.U,m.e,f.b,y.a,a.j.forChild([{path:"",component:S}])]]}),k)}}]);