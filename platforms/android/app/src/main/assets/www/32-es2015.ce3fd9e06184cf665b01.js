(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"1VCC":function(i,t,o){"use strict";o.d(t,"a",(function(){return n}));var s=o("fXoL"),e=o("TEn/");let n=(()=>{class i{constructor(){this.mostrar=!1}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=s.Kb({type:i,selectors:[["app-progress"]],inputs:{mostrar:"mostrar",titulo:"titulo"},decls:4,vars:2,consts:[[1,"centrado",3,"hidden"],[1,"titulo-item-2"],["type","indeterminate",1,"ion-margin-top"]],template:function(i,t){1&i&&(s.Vb(0,"div",0),s.Vb(1,"ion-label",1),s.zc(2),s.Ub(),s.Rb(3,"ion-progress-bar",2),s.Ub()),2&i&&(s.jc("hidden",!t.mostrar),s.Cb(2),s.Ac(t.titulo))},directives:[e.A,e.G],styles:[".centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}"]}),i})()},grgm:function(i,t,o){"use strict";o.r(t),o.d(t,"PreTiposatencionPageModule",(function(){return D}));var s=o("ofXK"),e=o("3Pt+"),n=o("TEn/"),a=o("tyNb"),r=o("mrSG"),c=o("wd/R"),d=o("hxmY"),l=o("/Lwr"),p=o("fXoL"),h=o("ymXj"),b=o("Li8n"),g=o("MTKf"),u=o("skLv"),m=o("kmnG"),f=o("d3UM"),C=o("1VCC"),v=o("FKr1");function A(i,t){if(1&i&&(p.Vb(0,"mat-option",12),p.zc(1),p.Ub()),2&i){const i=t.$implicit;p.jc("value",i.Texto),p.Cb(1),p.Ac(i.Texto)}}function I(i,t){if(1&i){const i=p.Wb();p.Vb(0,"ion-row",24),p.dc("click",(function(){p.rc(i);const t=p.gc().$implicit;return p.gc(2).citaSelected(t)})),p.Vb(1,"ion-col",25),p.zc(2),p.Ub(),p.Vb(3,"ion-col",26),p.zc(4),p.Ub(),p.Vb(5,"ion-col",27),p.zc(6),p.Ub(),p.Vb(7,"ion-col",28),p.zc(8),p.Ub(),p.Ub()}if(2&i){const i=p.gc().$implicit,t=p.gc(2);p.Cb(2),p.Bc(" ",i.Servicio.Nombre," "),p.Cb(2),p.Bc(" ",t.transformDateIso(i.FechaHoraInicio)," "),p.Cb(2),p.Bc(" ",t.transformDate(i.FechaHoraInicio,"dddd DD MMMM YYYY")," "),p.Cb(2),p.Cc(" ",i.NombresMedico.toLowerCase()," ",i.ApellidosMedico.toLowerCase()," ")}}function O(i,t){if(1&i&&(p.Vb(0,"ion-grid",22),p.yc(1,I,9,5,"ion-row",23),p.Ub()),2&i){const i=t.$implicit;p.Cb(1),p.jc("ngIf",i.indice<=3)}}function x(i,t){if(1&i){const i=p.Wb();p.Vb(0,"div"),p.Vb(1,"div",13),p.Vb(2,"h6",14),p.zc(3," Citas m\xe1s pr\xf3ximas "),p.Ub(),p.Vb(4,"p",15),p.zc(5," A continuaci\xf3n se listan los cupos disponibles m\xe1s pr\xf3ximos. "),p.Ub(),p.Ub(),p.Vb(6,"div",16),p.yc(7,O,2,1,"ion-grid",17),p.Ub(),p.Vb(8,"div",18),p.Vb(9,"p",19),p.zc(10," Si no te sirven los cupos propuesto prueba con la b\xfasqueda avanzada. "),p.Ub(),p.Ub(),p.Vb(11,"div",20),p.Vb(12,"ion-button",21),p.dc("click",(function(){return p.rc(i),p.gc().openBusquedaAvanzada()})),p.zc(13,"B\xdaSQUEDA AVANZADA"),p.Ub(),p.Ub(),p.Ub()}if(2&i){const i=p.gc();p.Cb(7),p.jc("ngForOf",i.citasFiltradas)}}function S(i,t){1&i&&(p.Vb(0,"div",29),p.Vb(1,"ion-label",30),p.zc(2,"No existen cupos con los criterios ingresados"),p.Ub(),p.Ub())}let T=(()=>{class i{constructor(i,t,o,s,e,n,a,r,c,d,l,p){this.navCtrl=i,this.toast=t,this.modalCtrl=o,this.platform=s,this.loading=e,this.menu=n,this.utiles=a,this.acceso=r,this.cita=c,this.parametrosApp=d,this.activatedRoute=l,this.router=p,this.miColor="#FF4081",this.textColor="#FFFFFF",this.runPaciente="",this.codigoDeis="",this.serviceType="349",this.tipoOperacion="disponibilidad",this.citas=[],this.citasFiltradas=[],this.tiposAtencion=[],this.comboSeleccionado="Selecciona...",this.idComboSeleccionado=0,this.mostrarProgress=!1,this.encontroCitas=!1,this.disabledCombo=!1,this.paginaActual=0,this.mostrarProgressDisp=!1,this.encontroCitasDisp=!1,this.idConsultar=0}ngOnInit(){return Object(r.b)(this,void 0,void 0,(function*(){c.locale("es"),this.activatedRoute.queryParams.subscribe(i=>Object(r.b)(this,void 0,void 0,(function*(){i&&i.Id?(this.idConsultar=i.Id,this.usuarioAps=this.utiles.entregaUsuario(i.Id),null!=this.usuarioAps?(this.usuarioAps.UrlImagen=this.utiles.entregaImagen(this.usuarioAps),this.miColor=this.utiles.entregaColor(this.usuarioAps),this.runPaciente=this.utiles.insertarGuion(this.usuarioAps.Rut),this.codigoDeis=this.usuarioAps.ConfiguracionNodo.CodigoDeis2014,this.nodId=this.usuarioAps.ConfiguracionNodo.NodId,this.crearTiposAtencion(),this.setFechasInicioFin(),this.parametrosApp.USA_API_MANAGEMENT()?yield this.buscarDisponibilidadApi(this.fechaInicio,this.fechaTermino,this.codigoDeis,this.runPaciente,this.serviceType,this.tipoOperacion):yield this.buscarDisponibilidad(this.fechaInicio,this.fechaTermino,this.codigoDeis,this.runPaciente,this.serviceType,this.tipoOperacion)):this.utiles.presentToast("No hay usuario, vuelva a seleccionar","bottom",2e3)):this.utiles.presentToast("No hay usuario, vuelva a seleccionar","bottom",2e3)})))}))}setFechasInicioFin(){var i=c().add(this.parametrosApp.HORAS_FECHA_INICIO(),"hour"),t=new Date;console.log(i),t=new Date(i.year(),i.month(),i.date(),0,0,0,0),console.log(t);var o=c().add(1,"month"),s=new Date(o.year(),o.month(),o.date(),23,59,0,0);console.log(o),console.log(s),this.fechaInicio=i.format(),this.fechaTermino=o.format(),sessionStorage.setItem("FECHA_INICIO_CONSULTA",this.fechaInicio),sessionStorage.setItem("FECHA_TERMINO_CONSULTA",this.fechaTermino)}buscarDisponibilidad(i,t,o,s,e,n){return Object(r.b)(this,void 0,void 0,(function*(){let a=yield this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});yield a.present().then(()=>Object(r.b)(this,void 0,void 0,(function*(){this.disabledCombo=!0,this.mostrarProgress=!0,this.citas=[],this.citasFiltradas=[],this.utiles.isAppOnDevice()?this.cita.getDisponibilidadNative(i,t,o,s,e,"","",n,this.nodId).then(i=>{var t=JSON.parse(i.data);this.procesarRespuestaTotal(t,a)}):this.cita.getDisponibilidad(i,t,o,s,e,"","",n,this.nodId).subscribe(i=>{this.procesarRespuestaTotal(i,a)})})))}))}buscarDisponibilidadApi(i,t,o,s,e,n){return Object(r.b)(this,void 0,void 0,(function*(){let a=yield this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});yield a.present().then(()=>Object(r.b)(this,void 0,void 0,(function*(){this.disabledCombo=!0,this.mostrarProgressDisp=!0,this.citas=[],this.citasFiltradas=[],this.utiles.isAppOnDevice()?this.cita.getDisponibilidadApiNative(i,t,o,s,e,"","",n,this.nodId).then(i=>{var t=JSON.parse(i.data);this.procesarRespuestaTotal(t,a)}).catch(i=>{console.log(i.message),a.dismiss(),this.disabledCombo=!1,this.mostrarProgressDisp=!1,this.utiles.presentToast("Se ha producido un error al obtener disponibilidad","bottom",2e3)}):this.cita.getDisponibilidadApi(i,t,o,s,e,"","",n,this.nodId).subscribe(i=>{this.procesarRespuestaTotal(i,a)},i=>{console.log(i.message),a.dismiss(),this.disabledCombo=!1,this.mostrarProgressDisp=!1,this.utiles.presentToast("Se ha producido un error al obtener disponibilidad","bottom",2e3)})})))}))}procesarRespuestaTotalDisp(i){this.citas=[],this.citasFiltradas=[],i&&i.Mensaje&&("correcto"==i.Mensaje.Codigo?(i.TiposAtencion&&this.agregarTiposAtencion(i.TiposAtencion),this.citas=i.CitasDisponibles,sessionStorage.setItem("CITAS_DISPONIBLES",JSON.stringify(this.citas))):(this.idComboSeleccionado=0,this.tiposAtencion=[],this.citas=[],this.citasFiltradas=[]),this.mostrarProgressDisp=!1,this.encontroCitasDisp=!0)}procesarRespuestaTotal(i,t){this.citas=[],this.citasFiltradas=[],i&&i.Mensaje&&("correcto"==i.Mensaje.Codigo?(i.TiposAtencion&&this.agregarTiposAtencion(i.TiposAtencion),this.citas=i.CitasDisponibles,sessionStorage.setItem("CITAS_DISPONIBLES",JSON.stringify(this.citas)),t.dismiss(),this.disabledCombo=!1,this.mostrarProgressDisp=!1,this.mostrarProgress=!1):(this.idComboSeleccionado=0,this.tiposAtencion=[],this.citas=[],this.citasFiltradas=[],t.dismiss(),this.disabledCombo=!1,this.mostrarProgressDisp=!1,this.mostrarProgress=!1))}indexarCitas(){this.citasFiltradas=[];var i=1;this.citas&&this.citas.length>0&&this.citas.forEach(t=>{t.TipoAtencion==this.comboSeleccionado&&(t.indice=i,this.citasFiltradas.push(t),i++)}),i>2&&(this.encontroCitas=!0)}crearTiposAtencion(){this.tiposAtencion=[],this.tiposAtencion.push({Texto:"Selecciona...",Valor:0,Selected:!0}),this.idComboSeleccionado=0}agregarTiposAtencion(i){var t=1;i&&i.length>0&&i.forEach(i=>{this.tiposAtencion.push({Texto:i,Valor:t,Selected:!1}),t++}),sessionStorage.setItem("TIPOS_ATENCION",JSON.stringify(this.tiposAtencion))}seleccionarItemCombo(){this.comboSeleccionado&&this.tiposAtencion&&(this.tiposAtencion.forEach(i=>{i.Selected=i.Texto==this.comboSeleccionado}),sessionStorage.setItem("TIPOS_ATENCION",JSON.stringify(this.tiposAtencion)))}buscarCitas(i){i.value&&(this.comboSeleccionado=i.value,this.mostrarProgress=!0,this.encontroCitas=!1,this.disabledCombo=!1,this.seleccionarItemCombo(),setTimeout(()=>{this.mostrarProgress=!1,this.disabledCombo=!0,this.indexarCitas()},2e3))}transformDate(i,t){return(new d.a).transform(i,t)}transformDateIso(i){var t="",o=i.split("T");if(o&&2==o.length){var s=o[1].split(":");s&&s.length>1&&(t=s[0]+":"+s[1])}return t}citaSelected(i){return Object(r.b)(this,void 0,void 0,(function*(){i&&(this.itemSelected=i);const t=yield this.modalCtrl.create({component:l.a,componentProps:{cita:JSON.stringify(i),operacion:"reservar"}});return t.onDidDismiss().then(i=>{i.data&&i.data.accion&&this.navCtrl.navigateRoot("calendario")}),yield t.present()}))}openBusquedaAvanzada(){this.navCtrl.navigateRoot(["busqueda-avanzada"],{queryParams:{Id:this.idConsultar}})}}return i.\u0275fac=function(t){return new(t||i)(p.Qb(n.Z),p.Qb(n.gb),p.Qb(n.Y),p.Qb(n.bb),p.Qb(n.W),p.Qb(n.X),p.Qb(h.a),p.Qb(b.a),p.Qb(g.a),p.Qb(u.a),p.Qb(a.a),p.Qb(a.g))},i.\u0275cmp=p.Kb({type:i,selectors:[["app-pre-tiposatencion"]],decls:16,vars:7,consts:[["color","primary","mode","md"],["slot","start"],["defaultHref","/calendario",1,"fcw"],[1,"fcw"],[1,"back-app"],["appearance","outline",1,"field-tipo-atencion"],[3,"disabled","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["titulo","Buscando citas",3,"mostrar"],["titulo","Buscando tipos atenci\xf3n",3,"mostrar"],[4,"ngIf"],["class","ion-padding-start ion-padding-end centrado",4,"ngIf"],[3,"value"],[1,"ion-padding-start","ion-padding-end"],[1,"titulo-item"],[1,"ion-text-wrap","texto-item"],[1,"ion-padding"],["class","ion-no-padding",4,"ngFor","ngForOf"],[1,"pl-24","pr-24"],[1,"ion-text-wrap","texto-item","ion-text-left"],[1,"ion-padding-top"],["expand","full","fill","clear",3,"click"],[1,"ion-no-padding"],["class","ion-padding-bottom ion-padding-top linea-item",3,"click",4,"ngIf"],[1,"ion-padding-bottom","ion-padding-top","linea-item",3,"click"],["size","9",1,"texto-item","ion-text-capitalize"],["size","3",1,"titulo-hora","ion-text-end"],["size","12",1,"ion-text-capitalize"],[1,"texto-item","ion-text-capitalize"],[1,"ion-padding-start","ion-padding-end","centrado"],[1,"ion-text-center","no-encontrado"]],template:function(i,t){1&i&&(p.Vb(0,"ion-header"),p.Vb(1,"ion-toolbar",0),p.Vb(2,"ion-buttons",1),p.Rb(3,"ion-back-button",2),p.Ub(),p.Vb(4,"ion-title",3),p.zc(5,"Reserva de horas"),p.Ub(),p.Ub(),p.Ub(),p.Vb(6,"ion-content",4),p.Vb(7,"mat-form-field",5),p.Vb(8,"mat-label"),p.zc(9,"Tipo atenci\xf3n"),p.Ub(),p.Vb(10,"mat-select",6),p.dc("ngModelChange",(function(i){return t.comboSeleccionado=i}))("selectionChange",(function(i){return t.buscarCitas(i)})),p.yc(11,A,2,2,"mat-option",7),p.Ub(),p.Ub(),p.Rb(12,"app-progress",8),p.Rb(13,"app-progress",9),p.yc(14,x,14,1,"div",10),p.yc(15,S,3,0,"div",11),p.Ub()),2&i&&(p.Cb(10),p.jc("disabled",t.disabledCombo)("ngModel",t.comboSeleccionado),p.Cb(1),p.jc("ngForOf",t.tiposAtencion),p.Cb(1),p.jc("mostrar",t.mostrarProgress),p.Cb(1),p.jc("mostrar",t.mostrarProgressDisp),p.Cb(1),p.jc("ngIf",t.encontroCitas),p.Cb(1),p.jc("ngIf",!t.encontroCitas&&0==t.mostrarProgress&&t.citasFiltradas.length>0))},directives:[n.u,n.T,n.i,n.e,n.f,n.R,n.p,m.c,m.g,f.a,e.k,e.n,s.j,C.a,s.k,v.j,n.h,n.t,n.K,n.o,n.A],styles:[".combo[_ngcontent-%COMP%]{width:100%;max-width:100%}.centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item[_ngcontent-%COMP%]{font-size:14px;color:rgba(0,0,0,.87);font-weight:700}.titulo-fecha[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}.titulo-hora[_ngcontent-%COMP%]{font-size:12px;color:rgba(0,0,0,.87)}.no-encontrado[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.54)}.pt-8[_ngcontent-%COMP%]{padding-top:8px}.pb-8[_ngcontent-%COMP%]{padding-bottom:8px}.pl-24[_ngcontent-%COMP%]{padding-left:24px}.pr-24[_ngcontent-%COMP%]{padding-right:24px}.linea-item[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12)}.borde[_ngcontent-%COMP%]{border-radius:5px;border:1px solid rgba(0,0,0,.12);padding:0 5px 5px}.label-tda[_ngcontent-%COMP%]{position:relative;top:-10px;margin-left:16px;padding-left:2px;padding-right:5px;background:#fff}.pt-32[_ngcontent-%COMP%]{padding-top:32px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}.centradoDisp[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:35%;padding-left:60px;padding-right:60px}"]}),i})();var P=o("j1ZV");let D=(()=>{class i{}return i.\u0275mod=p.Ob({type:i}),i.\u0275inj=p.Nb({factory:function(t){return new(t||i)},imports:[[s.c,e.g,n.U,m.e,f.b,P.a,a.j.forChild([{path:"",component:T}])]]}),i})()}}]);