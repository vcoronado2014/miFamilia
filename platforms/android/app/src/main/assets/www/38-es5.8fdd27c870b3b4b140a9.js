function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{vOkq:function(e,t,i){"use strict";i.r(t),i.d(t,"AjustesFamiliaPageModule",(function(){return v}));var s=i("ofXK"),a=i("3Pt+"),r=i("TEn/"),o=i("tyNb"),n=i("mrSG"),u=i("AytR"),c=i("fXoL"),l=i("ymXj"),g=i("qSmr");function m(e,t){if(1&e&&c.Rb(0,"img",8),2&e){var i=c.gc();c.jc("src",i.image,c.sc)}}function p(e,t){if(1&e){var i=c.Wb();c.Vb(0,"ion-list",9),c.Vb(1,"ion-item"),c.Vb(2,"ion-note",10),c.zc(3,"Seleccione el archivo"),c.Ub(),c.Ub(),c.Vb(4,"ion-item"),c.Vb(5,"ion-input",11),c.dc("change",(function(e){return c.rc(i),c.gc().changeListener(e)})),c.Ub(),c.Ub(),c.Ub()}}function f(e,t){1&e&&(c.Vb(0,"ion-item"),c.zc(1," No puede editar ya que no se encuentra registrado "),c.Ub())}var b,d,h=((b=function(){function e(t,i,s,a,r,o,n,u,c,l){_classCallCheck(this,e),this.modalCtrl=t,this.utiles=i,this.navCtrl=s,this.toast=a,this.platform=r,this.menu=o,this.loading=n,this.img=u,this.activatedRoute=c,this.router=l,this.image=null,this.lastImage=null,this.nombrePaciente="",this.color="#127bdc",this.miColor="#FF4081",this.tieneRegistro=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;localStorage.getItem("TIENE_REGISTRO")&&"true"==localStorage.getItem("TIENE_REGISTRO").toLowerCase()&&(this.tieneRegistro=!0),this.activatedRoute.queryParams.subscribe((function(t){t&&t.usuario&&(e.usuarioAps=JSON.parse(t.usuario),e.image=e.usuarioAps.UrlImagen,e.miColor=e.utiles.entregaColor(e.usuarioAps),e.color=e.miColor,e.nombrePaciente=e.usuarioAps.Nombres+" "+e.usuarioAps.ApellidoPaterno+" "+e.usuarioAps.ApellidoMaterno)}))}},{key:"setColor",value:function(e){this.color=e}},{key:"changeListener",value:function(e){this.fileP=e.target.files[0],this.fileP?this.fileP.size<=2048e3?this.putImagen(this.fileP):this.utiles.presentToast("El tama\xf1o de la im\xe1gen excede el m\xe1ximo permitido.","center",3e3):this.utiles.presentToast("No ha seleccionado ninguna im\xe1gen v\xe1lida.","center",3e3)}},{key:"putImagen",value:function(e){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,s,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.usuarioAps.Id.toString(),t.next=3,this.loading.create({message:"Guardando...<br>Imagen del usuario.",duration:2e4});case 3:return s=t.sent,t.next=6,s.present().then((function(){return Object(n.b)(a,void 0,void 0,regeneratorRuntime.mark((function t(){var a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.utiles.isAppOnDevice()?this.img.putImagenNative(i,e).then((function(e){if(e&&(a.image=u.a.URL_FOTOS+JSON.parse(e.data),a.usuarioAps&&a.usuarioAps.UrlImagen&&(a.usuarioAps.UrlImagen=u.a.URL_FOTOS+JSON.parse(e.data)),sessionStorage.UsuarioAps)){var t=JSON.parse(sessionStorage.UsuarioAps);if(t.Id==i)t.UrlImagen=JSON.parse(e.data),sessionStorage.setItem("UsuarioAps",JSON.stringify(t));else{var r=JSON.parse(localStorage.getItem("UsuariosFamilia"));r&&r.length>0&&(r.forEach((function(t){t.Id==i&&(t.UrlImagen=JSON.parse(e.data))})),localStorage.setItem("UsuariosFamilia",JSON.stringify(r)))}}s.dismiss()})):this.img.putImagen(i,e).subscribe((function(e){if(e&&(a.image=u.a.URL_FOTOS+e,a.usuarioAps&&a.usuarioAps.UrlImagen&&(a.usuarioAps.UrlImagen=u.a.URL_FOTOS+e),sessionStorage.UsuarioAps)){var t=JSON.parse(sessionStorage.UsuarioAps);if(t.Id==i)t.UrlImagen=e,sessionStorage.setItem("UsuarioAps",JSON.stringify(t));else{var r=JSON.parse(localStorage.getItem("UsuariosFamilia"));r&&r.length>0&&(r.forEach((function(t){t.Id==i&&(t.UrlImagen=e)})),localStorage.setItem("UsuariosFamilia",JSON.stringify(r)))}}s.dismiss()}));case 1:case"end":return t.stop()}}),t,this)})))}));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"putColor",value:function(){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.usuarioAps.Id.toString(),i=this.color,e.next=3,this.loading.create({message:"Guardando...<br>Color del usuario.",duration:2e4});case 3:return s=e.sent,e.next=6,s.present().then((function(){return Object(n.b)(a,void 0,void 0,regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.utiles.isAppOnDevice()?this.img.putColorNative(t,i).then((function(e){if(e&&(a.utiles.cambiaColorLocalStorage(JSON.parse(e.data)),a.color=JSON.parse(e.data),a.usuarioAps&&a.usuarioAps.Color&&(a.usuarioAps.Color=JSON.parse(e.data)),sessionStorage.UsuarioAps)){var i=JSON.parse(sessionStorage.UsuarioAps);if(i.Id==t)i.Color=JSON.parse(e.data),sessionStorage.setItem("UsuarioAps",JSON.stringify(i));else{var r=JSON.parse(localStorage.getItem("UsuariosFamilia"));r&&r.length>0&&(r.forEach((function(i){i.Id==t&&(i.Color=JSON.parse(e.data))})),localStorage.setItem("UsuariosFamilia",JSON.stringify(r)))}}s.dismiss()}),(function(e){s.dismiss(),a.utiles.presentToast(e,"bottom",4e3)})):this.img.putColor(t,i).subscribe((function(e){if(e){if(a.color=e,a.usuarioAps&&a.usuarioAps.Color&&(a.usuarioAps.Color=e),sessionStorage.UsuarioAps){var i=JSON.parse(sessionStorage.UsuarioAps);if(i.Id==t)i.Color=e,sessionStorage.setItem("UsuarioAps",JSON.stringify(i));else{var r=JSON.parse(localStorage.getItem("UsuariosFamilia"));r&&r.length>0&&(r.forEach((function(i){i.Id==t&&(i.Color=e)})),localStorage.setItem("UsuariosFamilia",JSON.stringify(r)))}}localStorage.setItem("MI_COLOR",e)}s.dismiss()}));case 1:case"end":return e.stop()}}),e,this)})))}));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"abrirEditar",value:function(){var e;e={usuario:JSON.stringify(this.usuarioAps)},this.navCtrl.navigateRoot(["contactabilidad"],{queryParams:e})}}]),e}()).\u0275fac=function(e){return new(e||b)(c.Qb(r.Y),c.Qb(l.a),c.Qb(r.Z),c.Qb(r.gb),c.Qb(r.bb),c.Qb(r.X),c.Qb(r.W),c.Qb(g.a),c.Qb(o.a),c.Qb(o.g))},b.\u0275cmp=c.Kb({type:b,selectors:[["app-ajustes-familia"]],decls:16,vars:4,consts:[[1,"back-app"],["color","primary","mode","md"],["slot","start"],["defaultHref","/familia",1,"fcw"],[1,"fcw"],[3,"src",4,"ngIf"],["lines","none",4,"ngIf"],[4,"ngIf"],[3,"src"],["lines","none"],["id","profile_image","color","primary"],["type","file","accept","image/*",3,"change"]],template:function(e,t){1&e&&(c.Vb(0,"ion-header",0),c.Vb(1,"ion-toolbar",1),c.Vb(2,"ion-buttons",2),c.Rb(3,"ion-back-button",3),c.Ub(),c.Vb(4,"ion-title",4),c.zc(5),c.Ub(),c.Ub(),c.Ub(),c.Vb(6,"ion-content",0),c.Vb(7,"ion-card"),c.Vb(8,"ion-card-header"),c.Vb(9,"ion-card-title"),c.zc(10,"Mi imagen"),c.Ub(),c.Ub(),c.Vb(11,"ion-card-content"),c.Vb(12,"div"),c.yc(13,m,1,1,"img",5),c.Ub(),c.Ub(),c.Ub(),c.yc(14,p,6,0,"ion-list",6),c.yc(15,f,2,0,"ion-item",7),c.Ub()),2&e&&(c.Cb(5),c.Bc("Ajustes ",t.nombrePaciente,""),c.Cb(8),c.jc("ngIf",t.image),c.Cb(1),c.jc("ngIf",t.tieneRegistro),c.Cb(1),c.jc("ngIf",!t.tieneRegistro))},directives:[r.u,r.T,r.i,r.e,r.f,r.R,r.p,r.j,r.l,r.n,r.k,s.k,r.B,r.z,r.F,r.y,r.fb],styles:[""]}),b),S=i("j1ZV"),v=((d=function e(){_classCallCheck(this,e)}).\u0275mod=c.Ob({type:d}),d.\u0275inj=c.Nb({factory:function(e){return new(e||d)},imports:[[s.c,a.g,r.U,S.a,o.j.forChild([{path:"",component:h}])]]}),d)}}]);