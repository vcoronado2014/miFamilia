{"version":3,"sources":["webpack:///src/app/nuevo-login/nuevo-login.page.html","webpack:///src/app/nuevo-login/nuevo-login.module.ts","webpack:///src/app/nuevo-login/nuevo-login.page.scss","webpack:///src/app/nuevo-login/nuevo-login.page.ts"],"names":["NuevoLoginPageModule","imports","forChild","path","component","declarations","NuevoLoginPage","navCtrl","utiles","servicioGeo","loading","formBuilder","activatedRoute","router","acceso","parametrosApp","fcmService","appVersion","platform","device","hide","patternOnlyLetter","expCelular","expPassword","expEmail","usaEnrolamiento","objetoEntrada","VersionAppName","Plataforma","Token","VersionAppNumber","Fecha","Date","TipoOperacion","Id","estaCargando","USA_LOGIN_ENROLAMIENTO","cargarForma","navigationExtras","queryParams","modulo","navigateRoot","forma","required","pattern","minLength","maxLength","get","clearValidators","create","cssClass","showBackdrop","spinner","loader","present","then","isAppOnDevice","localStorage","getItem","tokenDispositivo","Math","random","toString","setItem","versionAppName","versionNumber","plataforma","dismiss","is","getAppName","getVersionNumber","uuid","sessionStorage","JSON","stringify","postIngreso","subscribe","data","postIngresoNative","response","respuesta","parse","correo","controls","email","value","password","clave","encriptar","getRegistroAppCorreoPassword","registro","autentificarse","Run","presentToast","getRegistroAppNativeCorreoPassword","run","invalid","loguearseEnrolamiento","loguearseRegistro","userName","f","UserName","Password","UsaEnrolamiento","TokenFCM","entregaTokenFCM","loginWebDirecto","procesarLogin","error","loginWebNative","retorno","user","userFamilia","UsuarioAps","Rut","Nombres","ApellidoPaterno","Color","UrlImagen","UsuariosFamilia","hash","familia","filter","o","CodigoMensaje","RespuestaBase","Mensaje","loggedIn","tieneUsuario","NodId","USA_ENTIDAD_CONTRATANTE","EntidadContratante","length","setDatosUsuario","crearToken","registrarEntrada","irAHome","selector","template"],"mappings":"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","file":"nuevo-login-nuevo-login-module-es5.js","sourcesContent":["export default \"<ion-content class=\\\"ion-padding\\\">\\n  <app-progress [mostrar]=\\\"estaCargando\\\" titulo=\\\"Estamos ingresando a la app\\\"></app-progress>\\n\\n  <div [hidden]=\\\"estaCargando\\\" class=\\\"row mt-24\\\">\\n    <img src=\\\"../../assets/imgs_nuevas/login.png\\\" alt=\\\"asistente\\\"/>\\n  </div>\\n  <form [hidden]=\\\"estaCargando\\\" [formGroup]=\\\"forma\\\" novalidate>\\n    <ion-row class=\\\"ion-no-margin ion-no-padding mt-80\\\">\\n      <!-- solo para enrolamiento -->\\n      <mat-form-field appearance=\\\"outline\\\" style=\\\"width: 100%;\\\" [hidden]=\\\"usaEnrolamiento == false\\\">\\n        <mat-label>Run</mat-label>\\n        <input matInput placeholder=\\\"125458524\\\" formControlName=\\\"run\\\" name=\\\"run\\\">\\n        <mat-error [hidden]=\\\"usaEnrolamiento == false\\\">Run requerido</mat-error>\\n      </mat-form-field>\\n\\n      <mat-form-field appearance=\\\"outline\\\" style=\\\"width: 100%;\\\" [hidden]=\\\"usaEnrolamiento\\\">\\n        <mat-label>Correo electrónico</mat-label>\\n        <input matInput placeholder=\\\"ejemplo@gmail.com\\\" formControlName=\\\"email\\\" name=\\\"email\\\">\\n        <mat-error [hidden]=\\\"usaEnrolamiento\\\">Correo requerido</mat-error>\\n        <mat-error [hidden]=\\\"usaEnrolamiento\\\">Correo inválido</mat-error>\\n      </mat-form-field>\\n  \\n      <mat-form-field appearance=\\\"outline\\\" style=\\\"width: 100%;\\\">\\n        <mat-label>Contraseña</mat-label>\\n        <input matInput placeholder=\\\"Clave\\\" type=\\\"password\\\" name=\\\"clave\\\" formControlName=\\\"clave\\\" required>\\n        <mat-error [hidden]=\\\"!(f.clave.errors && f.clave.errors.required)\\\">Clave requerida</mat-error>\\n      </mat-form-field>\\n    </ion-row>\\n    <ion-row class=\\\"ion-no-padding ion-no-margin mt-40\\\">\\n      <button mat-raised-button color=\\\"primary\\\" style=\\\"width: 90%; margin-left: 5%; height:36px;\\\" (click)=\\\"onSubmit()\\\">INICIAR SESION</button>\\n    </ion-row>\\n  </form>\\n  <ion-row [hidden]=\\\"estaCargando\\\" class=\\\"mt-36\\\" [hidden]=\\\"usaEnrolamiento\\\">\\n    <a mat-button routerLink=\\\".\\\" color=\\\"primary\\\" class=\\\"ion-text-center\\\" style=\\\"width: 100%;\\\" (click)=\\\"irRecuperarClave()\\\">¿Olvidaste tu contraseña?</a>\\n  </ion-row>\\n  <ion-grid [hidden]=\\\"estaCargando\\\" class=\\\"ion-no-padding mt-36\\\">\\n    <ion-row>\\n      <ion-col class=\\\"ion-text-center texto-1\\\" style=\\\"margin-top:8px;\\\">\\n        ¿No tienes cuenta?\\n      </ion-col>\\n      <ion-col>\\n        <button (click)=\\\"abrirAsistente()\\\" mat-button color=\\\"primary\\\">REGISTRATE</button>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { RouterModule } from '@angular/router';\n\nimport { NuevoLoginPage } from './nuevo-login.page';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { ComponentsModule } from '../components/components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    MatFormFieldModule,\n    MatSelectModule,\n    MatInputModule,\n    MatButtonModule,\n    MatIconModule,\n    ComponentsModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        component: NuevoLoginPage\n      }\n    ])\n  ],\n  declarations: [NuevoLoginPage]\n})\nexport class NuevoLoginPageModule {}\n","export default \".mt-32 {\\n  margin-top: 32px;\\n}\\n\\n.mt-24 {\\n  margin-top: 24px;\\n}\\n\\n.mt-80 {\\n  margin-top: 5em;\\n}\\n\\n.mt-40 {\\n  margin-top: 2.5em;\\n}\\n\\n.mt-36 {\\n  margin-top: 2.25em;\\n}\\n\\n.texto-1 {\\n  font-size: 0.875em;\\n  color: #0000008A;\\n}\\n\\n.example-container .mat-form-field + .mat-form-field {\\n  margin-left: 8px;\\n}\\n\\n.example-right-align {\\n  text-align: right;\\n}\\n\\ninput.example-right-align::-webkit-outer-spin-button,\\ninput.example-right-align::-webkit-inner-spin-button {\\n  display: none;\\n}\\n\\ninput.example-right-align {\\n  -moz-appearance: textfield;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbnVldm8tbG9naW4vRjpcXGFwcF9taWZhbWlsaWFfZ2l0XFxtaUZhbWlsaWFfcHJlL3NyY1xcYXBwXFxudWV2by1sb2dpblxcbnVldm8tbG9naW4ucGFnZS5zY3NzIiwic3JjL2FwcC9udWV2by1sb2dpbi9udWV2by1sb2dpbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxnQkFBQTtBQ0NKOztBRENBO0VBQ0ksZ0JBQUE7QUNFSjs7QURBQTtFQUNJLGVBQUE7QUNHSjs7QUREQTtFQUNJLGlCQUFBO0FDSUo7O0FERkE7RUFDSSxrQkFBQTtBQ0tKOztBREhBO0VBQ0ksa0JBQUE7RUFDQSxnQkFBQTtBQ01KOztBREhBO0VBQ0ksZ0JBQUE7QUNNSjs7QURIRTtFQUNFLGlCQUFBO0FDTUo7O0FESEU7O0VBRUUsYUFBQTtBQ01KOztBREhFO0VBQ0UsMEJBQUE7QUNNSiIsImZpbGUiOiJzcmMvYXBwL251ZXZvLWxvZ2luL251ZXZvLWxvZ2luLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tdC0zMntcclxuICAgIG1hcmdpbi10b3A6IDMycHg7XHJcbn1cclxuLm10LTI0e1xyXG4gICAgbWFyZ2luLXRvcDogMjRweDtcclxufVxyXG4ubXQtODB7XHJcbiAgICBtYXJnaW4tdG9wOiA1ZW07XHJcbn1cclxuLm10LTQwe1xyXG4gICAgbWFyZ2luLXRvcDogMi41ZW07XHJcbn1cclxuLm10LTM2e1xyXG4gICAgbWFyZ2luLXRvcDogMi4yNWVtO1xyXG59XHJcbi50ZXh0by0xe1xyXG4gICAgZm9udC1zaXplOiAwLjg3NWVtO1xyXG4gICAgY29sb3I6ICMwMDAwMDA4QTtcclxuICAgIFxyXG59XHJcbi5leGFtcGxlLWNvbnRhaW5lciAubWF0LWZvcm0tZmllbGQgKyAubWF0LWZvcm0tZmllbGQge1xyXG4gICAgbWFyZ2luLWxlZnQ6IDhweDtcclxuICB9XHJcbiAgXHJcbiAgLmV4YW1wbGUtcmlnaHQtYWxpZ24ge1xyXG4gICAgdGV4dC1hbGlnbjogcmlnaHQ7XHJcbiAgfVxyXG4gIFxyXG4gIGlucHV0LmV4YW1wbGUtcmlnaHQtYWxpZ246Oi13ZWJraXQtb3V0ZXItc3Bpbi1idXR0b24sXHJcbiAgaW5wdXQuZXhhbXBsZS1yaWdodC1hbGlnbjo6LXdlYmtpdC1pbm5lci1zcGluLWJ1dHRvbiB7XHJcbiAgICBkaXNwbGF5OiBub25lO1xyXG4gIH1cclxuICBcclxuICBpbnB1dC5leGFtcGxlLXJpZ2h0LWFsaWduIHtcclxuICAgIC1tb3otYXBwZWFyYW5jZTogdGV4dGZpZWxkO1xyXG4gIH0iLCIubXQtMzIge1xuICBtYXJnaW4tdG9wOiAzMnB4O1xufVxuXG4ubXQtMjQge1xuICBtYXJnaW4tdG9wOiAyNHB4O1xufVxuXG4ubXQtODAge1xuICBtYXJnaW4tdG9wOiA1ZW07XG59XG5cbi5tdC00MCB7XG4gIG1hcmdpbi10b3A6IDIuNWVtO1xufVxuXG4ubXQtMzYge1xuICBtYXJnaW4tdG9wOiAyLjI1ZW07XG59XG5cbi50ZXh0by0xIHtcbiAgZm9udC1zaXplOiAwLjg3NWVtO1xuICBjb2xvcjogIzAwMDAwMDhBO1xufVxuXG4uZXhhbXBsZS1jb250YWluZXIgLm1hdC1mb3JtLWZpZWxkICsgLm1hdC1mb3JtLWZpZWxkIHtcbiAgbWFyZ2luLWxlZnQ6IDhweDtcbn1cblxuLmV4YW1wbGUtcmlnaHQtYWxpZ24ge1xuICB0ZXh0LWFsaWduOiByaWdodDtcbn1cblxuaW5wdXQuZXhhbXBsZS1yaWdodC1hbGlnbjo6LXdlYmtpdC1vdXRlci1zcGluLWJ1dHRvbixcbmlucHV0LmV4YW1wbGUtcmlnaHQtYWxpZ246Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24ge1xuICBkaXNwbGF5OiBub25lO1xufVxuXG5pbnB1dC5leGFtcGxlLXJpZ2h0LWFsaWduIHtcbiAgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7XG59Il19 */\";","import { Component, OnInit } from '@angular/core';\nimport { NavController, LoadingController, Platform } from '@ionic/angular';\nimport { FormGroup, Validators, FormBuilder, FormControl, ValidatorFn } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\n//servicios\nimport { ServicioUtiles } from '../../app/services/ServicioUtiles';\nimport { ServicioGeo } from '../../app/services/ServicioGeo';\nimport { ServicioAcceso } from '../../app/services/ServicioAcceso';\nimport { ServicioParametrosApp } from '../../app/services/ServicioParametrosApp';\nimport { ServicioFCM } from '../../app/services/ServicioFCM';\nimport { NavigationExtras } from '@angular/router';\nimport { AppVersion } from '@ionic-native/app-version/ngx';\nimport { Device } from '@ionic-native/device/ngx';\n\nimport * as moment from 'moment';\n\n\n//estoy implementando progress bar\n//aca hay que controlar cuando no hay internet\n\n@Component({\n  selector: 'app-nuevo-login',\n  templateUrl: './nuevo-login.page.html',\n  styleUrls: ['./nuevo-login.page.scss'],\n})\nexport class NuevoLoginPage implements OnInit {\n  hide = true;\n\n  registro;\n  forma: FormGroup;\n  nombreMostrar;\n  //para validar\n  patternOnlyLetter = '[a-zA-ZÀ-ÿ\\u00f1\\u00d1]+(\\s*[a-zA-ZÀ-ÿ\\u00f1\\u00d1]*)*[a-zA-ZÀ-ÿ\\u00f1\\u00d1 ]+$';\n  expCelular = /^(\\+?56)?(\\s?)(0?9)(\\s?)[9876543]\\d{7}$/gm;\n  expPassword = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{4,8}$/gm;\n  expEmail = /^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/gm;\n  isLogged: boolean;\n  loggedIn: boolean;\n  CodigoMensaje: any;\n  Mensaje: string;\n  tokenDispositivo;\n  //para validarse solo con enrolamiento\n  usaEnrolamiento = false;\n  //PARA REGISTRAR EL MOVIMIENTO DE INGRESO\n  objetoEntrada = {\n    VersionAppName: '',\n    Plataforma: '',\n    Token: '',\n    VersionAppNumber: '',\n    Fecha: new Date(),\n    TipoOperacion: '0',\n    Id: '0'\n  };\n  //para progress bar\n  estaCargando = false;\n\n\n  constructor(\n    private navCtrl: NavController,\n    public utiles: ServicioUtiles,\n    public servicioGeo: ServicioGeo,\n    public loading: LoadingController,\n    private formBuilder: FormBuilder,\n    public activatedRoute: ActivatedRoute,\n    private router: Router,\n    public acceso: ServicioAcceso,\n    public parametrosApp: ServicioParametrosApp,\n    public fcmService: ServicioFCM,\n    public appVersion: AppVersion,\n    public platform: Platform,\n    public device: Device,\n  ) { }\n\n  ngOnInit() {\n    moment.locale('es');\n    this.usaEnrolamiento = this.parametrosApp.USA_LOGIN_ENROLAMIENTO();\n    this.cargarForma();\n  }\n  abrirAsistente(){\n    const navigationExtras: NavigationExtras = {\n      queryParams: {\n        modulo: 'nuevo-login'\n      }\n    }\n    this.navCtrl.navigateRoot(['pre-registro-uno'], navigationExtras);\n  }\n  cargarForma(){\n    this.forma = new FormGroup({\n      'run': new FormControl('', [Validators.required]),\n      'email': new FormControl('', [Validators.required, Validators.pattern(this.expEmail)]),\n      'clave':new FormControl('', [Validators.required, Validators.minLength(3), Validators.maxLength(10)])    \n    });\n    //si usa enrolamiento hay que quitar validación de email\n    if (this.usaEnrolamiento){\n      this.forma.get('email').clearValidators();\n    }\n    else{\n      this.forma.get('run').clearValidators();\n    }\n    //acá ver si dejamos preseteado el usuario y clave\n    //por lo pronto lo comentamos\n\n/*     if (this.registro && this.registro.Id > 0){\n      this.forma.setValue({\n        run: this.registro.Run,\n        email: this.registro.CorreoElectronico,\n        nombre: this.registro.Nombres,\n        apellido: this.registro.Apellidos,\n        telefono: this.registro.TelefonoContacto,\n        genero: this.registro.Sexo.toString(),\n        clave: '',\n        repetirClave: ''\n      })\n    } */\n  }\n  async crearToken(){\n    var versionAppName;\n    var versionNumber;\n    var plataforma;\n    //original\n/*     let loader = await this.loading.create({\n      message: 'Creando...<br>Token inicial',\n      duration: 2000\n    }); */\n    this.estaCargando = true;\n    let loader = await this.loading.create({\n      cssClass: 'loading-vacio',\n      showBackdrop: false,\n      spinner:null,\n    });\n\n    await loader.present().then(async () => {\n      if (!this.utiles.isAppOnDevice()) {\n        //web\n        //guardar local storage\n        if (!localStorage.getItem('token_dispositivo')) {\n          //crear token para web\n          this.tokenDispositivo = (Math.random() * (1000000 - 1) + 1).toString() + ' web';\n          localStorage.setItem('token_dispositivo', this.tokenDispositivo);\n        }\n        else {\n          this.tokenDispositivo = localStorage.getItem('token_dispositivo');\n        }\n        versionAppName = \"Mi salud familiar\"\n        versionNumber = \"0.0\";\n        plataforma = \"Web\";\n        //loader.dismiss();\n        //otras variables\n        localStorage.setItem('version_app_name', versionAppName);\n        localStorage.setItem('version_number', versionNumber);\n        localStorage.setItem('plataforma', plataforma);\n        loader.dismiss();\n        this.estaCargando = false;\n      }\n      else {\n        if (this.platform.is('ios')){\n          versionAppName = await this.appVersion.getAppName();\n          versionNumber = await this.appVersion.getVersionNumber();\n          plataforma = \"iOS\";\n        } \n        else if (this.platform.is('android')){\n          versionAppName = await this.appVersion.getAppName();\n          versionNumber = await this.appVersion.getVersionNumber();\n          plataforma = \"Android\";\n        }\n        else if (this.platform.is('mobileweb')){\n          versionAppName = \"Mi salud familiar\"\n          versionNumber = \"0.0\";\n          plataforma = \"Web\";\n        }\n        else {\n          versionAppName = \"Mi salud familiar\"\n          versionNumber = \"0.0\";\n          plataforma = \"No informado\";\n        }\n        //crear token para web\n        this.tokenDispositivo = this.device.uuid;\n        localStorage.setItem('token_dispositivo', this.tokenDispositivo);\n        //otras variables\n        localStorage.setItem('version_app_name', versionAppName);\n        localStorage.setItem('version_number', versionNumber);\n        localStorage.setItem('plataforma', plataforma);\n        loader.dismiss();\n        this.estaCargando = false;\n      }\n\n    })\n  }\n  async registrarEntrada(){\n    //variable de session que identifica el ingreso\n    if (!sessionStorage.getItem('RSS_ID')){\n      this.objetoEntrada.VersionAppName = localStorage.getItem('version_app_name');\n      this.objetoEntrada.Plataforma = localStorage.getItem('plataforma');\n      this.objetoEntrada.VersionAppNumber = localStorage.getItem('version_number');\n      this.objetoEntrada.Token = localStorage.getItem('token_dispositivo');\n      this.objetoEntrada.Fecha = new Date();\n      //GUARDAMOS EN LA SESSION PARA OCUPARLO DESPUES\n      sessionStorage.setItem('ENTRADA', JSON.stringify(this.objetoEntrada));\n      //original\n/*       let loader = await this.loading.create({\n        message: 'Creando...<br>registro de sessión',\n        duration: 2000\n      }); */\n      this.estaCargando = true;\n      let loader = await this.loading.create({\n        cssClass: 'loading-vacio',\n        showBackdrop: false,\n        spinner:null,\n      });\n\n      await loader.present().then(async () => {\n        if (!this.utiles.isAppOnDevice()) {\n          //web\n          this.servicioGeo.postIngreso(this.objetoEntrada).subscribe((data: any) => {\n            if (data){\n              if (data.Id > 0){\n                //guardamos el identificador del registro para procesarlo despues\n                sessionStorage.setItem(\"RSS_ID\", data.Id);\n  \n              }\n            }\n            loader.dismiss();\n            this.estaCargando = false;\n          });\n        }\n        else {\n          //dispositivo\n          this.servicioGeo.postIngresoNative(this.objetoEntrada).then(response => {\n            let respuesta = JSON.parse(response.data);\n            sessionStorage.setItem(\"RSS_ID\", respuesta.Id);\n            loader.dismiss();\n            this.estaCargando = false;\n          });\n        }\n      });\n\n\n    }\n  }\n  async loguearseRegistro(){\n    let correo = this.forma.controls.email.value;\n    let password = this.forma.controls.clave ? this.utiles.encriptar(this.forma.controls.clave.value) : '';\n\n    //ahora guardamos\n    //original\n/*     let loader = await this.loading.create({\n      message: 'Creando...<br>Registro',\n      duration: 20000\n    }); */\n    this.estaCargando = true;\n    let loader = await this.loading.create({\n      cssClass: 'loading-vacio',\n      showBackdrop: false,\n      spinner:null,\n    });\n    await loader.present().then(async () => {\n      if (!this.utiles.isAppOnDevice()) {\n        //llamada web\n        this.servicioGeo.getRegistroAppCorreoPassword(correo, password).subscribe((data)=>{\n          if (data){\n            let respuesta = data;\n            localStorage.setItem('REGISTRO', JSON.stringify(respuesta));\n            localStorage.setItem('TIENE_REGISTRO', 'true');\n            loader.dismiss();\n            let registro = JSON.parse(localStorage.getItem('REGISTRO'));\n\n            this.autentificarse(registro.Run, password);\n          }\n          else{\n            this.utiles.presentToast(\"No se encontró registro de usuario.\", \"middle\", 3000);\n            this.estaCargando = false;\n            loader.dismiss();\n            return;\n          }\n\n        })\n      }\n      else{\n        //llamada nativa\n        this.servicioGeo.getRegistroAppNativeCorreoPassword(correo, password).then((data)=>{\n          let respuesta = JSON.parse(data.data);\n          if (respuesta) {\n            localStorage.setItem('REGISTRO', JSON.stringify(respuesta));\n            localStorage.setItem('TIENE_REGISTRO', 'true');\n            loader.dismiss();\n            let registro = JSON.parse(localStorage.getItem('REGISTRO'));\n            this.autentificarse(registro.Run, password);\n          }\n          else{\n            this.utiles.presentToast(\"No se encontró registro de usuario.\", \"middle\", 3000);\n            this.estaCargando = false;\n            loader.dismiss();\n            return;\n          }\n\n        })\n      }\n    })\n  }\n\n  async loguearseEnrolamiento(){\n    this.estaCargando = true;\n    let run = this.forma.controls.run.value;\n    let password = this.forma.controls.clave ? this.utiles.encriptar(this.forma.controls.clave.value) : '';\n    localStorage.setItem('TIENE_REGISTRO', 'false');\n    this.autentificarse(run, password);\n  }\n\n  async onSubmit() {\n    if (this.forma.invalid) {\n      return;\n    } \n    if (this.usaEnrolamiento){\n      //loguearse con enrolamiento\n      this.loguearseEnrolamiento();\n    }\n    else{\n      //loguearse con registro app\n      this.loguearseRegistro();\n    }\n  }\n  async autentificarse(userName, password){\n    //en este caso ya el user name es el email\n\n    let f = { UserName: userName, Password: password, UsaEnrolamiento: this.usaEnrolamiento, TokenFCM: this.utiles.entregaTokenFCM() };\n    //original\n/*     let loader = await this.loading.create({\n      message: 'Obteniendo...<br>Login',\n      duration: 10000\n    }); */\n    this.estaCargando = true;\n    let loader = await this.loading.create({\n      cssClass: 'loading-vacio',\n      showBackdrop: false,\n      spinner:null,\n    });\n\n\n    await loader.present().then(async () => {\n      if (!this.utiles.isAppOnDevice()) {\n        //llamada web\n        this.acceso.loginWebDirecto(f).subscribe((response: any)=>{\n          this.procesarLogin(response, loader);\n        },\n        (error)=>{\n          loader.dismiss();\n          this.estaCargando = false;\n          return;\n        });\n      }\n      else{\n        //llamada nativa\n        this.acceso.loginWebNative(f).then((response: any)=>{\n          this.procesarLogin(JSON.parse(response.data), loader);\n        },\n        (error)=>{\n          this.utiles.presentToast('Ocurrió un error de autentificación', 'bottom', 4000);\n          this.estaCargando = false;\n          loader.dismiss();\n          return;\n        }\n        );\n      }\n    })\n  }\n  setDatosUsuario(retorno, user, userFamilia) {\n    //variable de sessión muy importante para el resto de la app.\n    sessionStorage.setItem(\"UsuarioAps\", user);\n    localStorage.setItem('MI_RUT', retorno.UsuarioAps.Rut);\n    localStorage.setItem('MI_NOMBRE', retorno.UsuarioAps.Nombres + ' ' + retorno.UsuarioAps.ApellidoPaterno);\n    localStorage.setItem('MI_COLOR', retorno.UsuarioAps.Color);\n    localStorage.setItem('MI_IMAGEN', retorno.UsuarioAps.UrlImagen);\n    //lo vamos a guardar en el local storage para realizar la llamada\n    //en el background\n    localStorage.setItem('UsuarioAps', user);\n    if (retorno.UsuariosFamilia) {\n      //debemos quitar los repetidos según última revisión\n      let hash = {};\n      var familia = retorno.UsuariosFamilia.filter(o => hash[o.Id] ? false : hash[o.Id] = true);\n      retorno.UsuariosFamilia = familia;\n      userFamilia = JSON.stringify(retorno.UsuariosFamilia);\n      //variable de sessión muy importante para el resto de la app.\n      localStorage.setItem(\"UsuariosFamilia\", userFamilia);\n    }\n\n\n    this.CodigoMensaje = retorno.RespuestaBase.CodigoMensaje;\n    this.Mensaje = retorno.RespuestaBase.Mensaje;\n\n    this.loggedIn = true;\n/*     this.fcmService.initFCM();\n    this.fcmService.receiveMessage(true); */\n  }\n  procesarLogin(response, loader){\n    var retorno = response;\n    let tieneUsuario = false;\n    if (retorno.RespuestaBase){\n      if (retorno.RespuestaBase.CodigoMensaje == 0) {\n        //esta todo ok\n        var user;\n        var userFamilia;\n        if (retorno.UsuarioAps){\n          user = JSON.stringify(retorno.UsuarioAps);\n          //antes debemos validar si tiene entidad contratante\n          if (user.NodId && this.parametrosApp.USA_ENTIDAD_CONTRATANTE()){\n            //usa entidad contratante y tiene nodo\n            if (retorno.UsuarioAps.EntidadContratante && retorno.UsuarioAps.EntidadContratante.length > 0){\n              //tiene entidad contratante\n              tieneUsuario = true;\n              this.setDatosUsuario(retorno, user, userFamilia);\n              loader.dismiss();\n              this.estaCargando = false;\n            }\n            else{\n              //no tiene entidad contratante\n              this.utiles.presentToast(\"No tiene entidad contratante asociada\", \"middle\", 3000);\n              loader.dismiss();\n              this.estaCargando = false;\n              return;\n            }\n          }\n          else {\n            //no usa entidad contratante\n            tieneUsuario = true;\n            this.setDatosUsuario(retorno, user, userFamilia);\n            loader.dismiss();\n            this.estaCargando = false;\n          }\n              \n        }\n\n        //si tiene usuario está valido\n        if (!tieneUsuario){\n          this.utiles.presentToast(\"Tiene registro correcto, pero no cuenta con información en la red de salud.\", \"middle\", 3000);\n        }\n        this.crearToken();\n        //guardamos el registro de session\n        this.registrarEntrada();\n        this.irAHome();\n      }\n      else {\n        this.loggedIn = false;\n        this.CodigoMensaje = retorno.RespuestaBase.CodigoMensaje;\n        this.Mensaje = retorno.RespuestaBase.Mensaje;\n        this.loggedIn = true;\n        loader.dismiss();\n        this.estaCargando = false;\n        this.utiles.presentToast(this.Mensaje, 'middle', 4000);\n        return;\n      }\n\n    }\n    else{\n      //error también\n      this.loggedIn = false;\n      this.CodigoMensaje = 1000;\n      this.Mensaje = 'Error de llamada Http;';\n      this.loggedIn = true;\n      this.estaCargando = false;\n      loader.dismiss();\n      this.utiles.presentToast(this.Mensaje, 'middle', 4000);\n      return;\n    }\n  }\n  irAHome(){\n    this.navCtrl.navigateRoot('home');\n  }\n  irRecuperarClave(){\n    this.navCtrl.navigateRoot('recuperar-clave');\n  }\n  get f() { return this.forma.controls; }\n}\n"]}