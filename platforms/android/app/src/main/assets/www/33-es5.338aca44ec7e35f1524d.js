function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"1VCC":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var a=i("fXoL"),s=i("TEn/"),o=function(){var t=function(){function t(){_classCallCheck(this,t),this.mostrar=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Kb({type:t,selectors:[["app-progress"]],inputs:{mostrar:"mostrar",titulo:"titulo"},decls:4,vars:2,consts:[[1,"centrado",3,"hidden"],[1,"titulo-item-2"],["type","indeterminate",1,"ion-margin-top"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"ion-label",1),a.zc(2),a.Ub(),a.Rb(3,"ion-progress-bar",2),a.Ub()),2&t&&(a.jc("hidden",!e.mostrar),a.Cb(2),a.Ac(e.titulo))},directives:[s.A,s.G],styles:[".centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}"]}),t}()},bySQ:function(t,e,i){"use strict";i.r(e),i.d(e,"QuitarFamiliaPageModule",(function(){return S}));var a=i("ofXK"),s=i("3Pt+"),o=i("TEn/"),r=i("tyNb"),n=i("mrSG"),c=i("fXoL"),l=i("ymXj"),u=i("w9zE"),d=i("Li8n"),g=i("skLv"),m=i("1VCC"),h=i("bTqV");function p(t,e){if(1&t){var i=c.Wb();c.Vb(0,"div"),c.Vb(1,"ion-item",11),c.Vb(2,"ion-grid"),c.Vb(3,"ion-row"),c.Vb(4,"ion-col",12),c.Vb(5,"h3",13),c.zc(6),c.Ub(),c.Ub(),c.Vb(7,"ion-col",14),c.Vb(8,"ion-toggle",15),c.dc("ngModelChange",(function(t){return c.rc(i),e.$implicit.EsAceptado=t})),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()}if(2&t){var a=e.$implicit;c.Cb(6),c.Ac(a.NombreCompleto),c.Cb(2),c.jc("checked",a.EsAceptado)("ngModel",a.EsAceptado)}}function f(t,e){if(1&t){var i=c.Wb();c.Vb(0,"div",8),c.yc(1,p,9,3,"div",9),c.Vb(2,"ion-row"),c.Vb(3,"button",10),c.dc("click",(function(){return c.rc(i),c.gc().onSubmit()})),c.zc(4,"GUARDAR"),c.Ub(),c.Ub(),c.Ub()}if(2&t){var a=c.gc();c.Cb(1),c.jc("ngForOf",a.familiaAsociar),c.Cb(2),c.jc("disabled",0==a.familiaAsociar.length)}}var b,A,C=((b=function(){function t(e,i,a,s,o,r,n,c,l,u,d,g,m){_classCallCheck(this,t),this.navCtrl=e,this.toast=i,this.modalCtrl=a,this.platform=s,this.menu=o,this.activatedRoute=r,this.router=n,this.utiles=c,this.loading=l,this.servicioGeo=u,this.acceso=d,this.parametrosApp=g,this.alertController=m,this.familiaAsociar=[],this.estaCargando=!1,this.tituloProgress="",this.nombreUsuario="",this.password="",this.usaEnrolamiento=!1}return _createClass(t,[{key:"ngOnInit",value:function(){if(this.usaEnrolamiento=this.parametrosApp.USA_LOGIN_ENROLAMIENTO(),localStorage.getItem("REGISTRO")){var t=JSON.parse(localStorage.getItem("REGISTRO"));this.usaEnrolamiento&&localStorage.setItem("TIENE_REGISTRO","false"),this.nombreUsuario=t.Run,this.password=t.Password}this.buscar()}},{key:"buscar",value:function(){if(localStorage.getItem("FAMILIA-ACEPTADA")){var t=JSON.parse(localStorage.getItem("FAMILIA-ACEPTADA"));if(t.length>0)for(var e=0;e<t.length;e++)t[e].Run=this.utiles.insertarGuion(t[e].Run),t[e].EsAceptado=1==t[e].Aceptado,this.familiaAsociar.push(t[e])}if(localStorage.getItem("FAMILIA-RECHAZADA")){var i=JSON.parse(localStorage.getItem("FAMILIA-RECHAZADA"));if(i.length>0)for(e=0;e<i.length;e++)i[e].Run=this.utiles.insertarGuion(i[e].Run),i[e].EsAceptado=1==i[e].Aceptado,this.familiaAsociar.push(i[e])}}},{key:"procesarFamilia",value:function(){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,i,a,s,o,r,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.familiaAsociar&&this.familiaAsociar.length>0)){t.next=9;break}for(e=this.familiaAsociar[0].UspIdTitular.toString(),i=[],a=0;a<this.familiaAsociar.length;a++)s=this.familiaAsociar[a],o=s.EsAceptado?"1":"0",i.push(s.UspId.toString()+";"+o);return i&&0==i.length&&i.push("0;0"),this.estaCargando=!0,this.tituloProgress="Guardando informaci\xf3n de la familia",t.next=6,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});case 6:return r=t.sent,t.next=9,r.present().then((function(){return Object(n.b)(c,void 0,void 0,regeneratorRuntime.mark((function t(){var a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.quitarFamiliaNative(i.toString(),e).then((function(t){JSON.parse(t.data)?(r.dismiss(),a.estaCargando=!1,a.tituloProgress="",console.log("autentificarse"),a.autentificarse()):(r.dismiss(),a.estaCargando=!1,a.tituloProgress="",a.utiles.presentToast("Ocurri\xf3 un error al asociar familia","bottom",3e3))})).catch((function(t){console.log(t.message),r.dismiss(),a.estaCargando=!1,a.tituloProgress="",a.utiles.presentToast("Ocurri\xf3 un error al asociar familia","bottom",3e3)})):this.servicioGeo.quitarFamilia(i.toString(),e).subscribe((function(t){t?(r.dismiss(),a.estaCargando=!1,a.tituloProgress="",a.autentificarse()):(r.dismiss(),a.estaCargando=!1,a.tituloProgress="",a.utiles.presentToast("Ocurri\xf3 un error al asociar familia","bottom",3e3))}),(function(t){console.log(t.message),r.dismiss(),a.estaCargando=!1,a.tituloProgress="",a.utiles.presentToast("Ocurri\xf3 un error al asociar familia","bottom",3e3)}));case 1:case"end":return t.stop()}}),t,this)})))}));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"onSubmit",value:function(){this.familiaAsociar&&this.familiaAsociar.length>0?this.familiaAsociar.filter((function(t){return 0==t.EsAceptado})).length>0?(console.log("infromar que no esta aceptando a todos los miembros, si esta seguro de continuar"),this.presentAlertConfirm("Aviso","Hay al menos un miembro de la familia al cual no est\xe1 aceptando.\n\xbfEst\xe1 seguro de continuar?.")):this.procesarFamilia():this.utiles.presentToast("No hay miembros de la familia para quitar","bottom",3e3)}},{key:"presentAlertConfirm",value:function(t,e){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var a,s=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.alertController.create({header:t,message:e,buttons:[{text:"No",role:"cancel",cssClass:"danger",handler:function(t){console.log("Confirm Cancel: blah")}},{text:"Si",cssClass:"success",handler:function(){s.procesarFamilia()}}]});case 2:return a=i.sent,i.next=5,a.present();case 5:case"end":return i.stop()}}),i,this)})))}},{key:"autentificarse",value:function(){return Object(n.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,i,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={UserName:this.nombreUsuario,Password:this.password,UsaEnrolamiento:this.usaEnrolamiento,TokenFCM:this.utiles.entregaTokenFCM()},this.estaCargando=!0,this.tituloProgress="Volviendo a autentificar, espere un momento",t.next=4,this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});case 4:return i=t.sent,t.next=7,i.present().then((function(){return Object(n.b)(a,void 0,void 0,regeneratorRuntime.mark((function t(){var a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.utiles.isAppOnDevice()?this.acceso.loginWebNative(e).then((function(t){a.procesarLogin(JSON.parse(t.data),i)}),(function(t){console.log(t.message),a.utiles.presentToast("Ocurri\xf3 un error de autentificaci\xf3n","bottom",4e3),a.estaCargando=!1,i.dismiss(),a.tituloProgress=""})):this.acceso.loginWebDirecto(e).subscribe((function(t){a.procesarLogin(t,i)}),(function(t){console.log(t.message),i.dismiss(),a.estaCargando=!1,a.tituloProgress=""}));case 1:case"end":return t.stop()}}),t,this)})))}));case 7:case"end":return t.stop()}}),t,this)})))}},{key:"procesarLogin",value:function(t,e){var i,a=t,s=!1;if(!a.RespuestaBase)return this.loggedIn=!1,this.CodigoMensaje=1e3,this.Mensaje="Error de llamada Http;",this.loggedIn=!0,this.estaCargando=!1,e.dismiss(),void this.utiles.presentToast(this.Mensaje,"middle",4e3);if(0!=a.RespuestaBase.CodigoMensaje)return this.CodigoMensaje=a.RespuestaBase.CodigoMensaje,this.Mensaje=a.RespuestaBase.Mensaje,e.dismiss(),this.estaCargando=!1,void this.utiles.presentToast(this.Mensaje,"middle",4e3);if(a.UsuarioAps)if((i=JSON.stringify(a.UsuarioAps)).NodId&&this.parametrosApp.USA_ENTIDAD_CONTRATANTE()){if(!(a.UsuarioAps.EntidadContratante&&a.UsuarioAps.EntidadContratante.length>0))return this.utiles.presentToast("No tiene entidad contratante asociada","middle",3e3),e.dismiss(),this.estaCargando=!1,void(this.tituloProgress="");s=!0,this.setDatosUsuario(a,i,void 0),e.dismiss(),this.estaCargando=!1,this.tituloProgress=""}else s=!0,this.setDatosUsuario(a,i,void 0),e.dismiss(),this.estaCargando=!1,this.tituloProgress="";s||this.utiles.presentToast("Tiene registro correcto, pero no cuenta con informaci\xf3n en la red de salud.","middle",3e3),this.irAHome()}},{key:"setDatosUsuario",value:function(t,e,i){if(sessionStorage.setItem("UsuarioAps",e),localStorage.setItem("MI_RUT",t.UsuarioAps.Rut),localStorage.setItem("MI_NOMBRE",t.UsuarioAps.Nombres+" "+t.UsuarioAps.ApellidoPaterno),localStorage.setItem("MI_COLOR",t.UsuarioAps.Color),localStorage.setItem("MI_IMAGEN",t.UsuarioAps.UrlImagen),localStorage.setItem("UsuarioAps",e),t.UsuariosFamilia){var a={},s=t.UsuariosFamilia.filter((function(t){return!a[t.Id]&&(a[t.Id]=!0)}));t.UsuariosFamilia=s,i=JSON.stringify(t.UsuariosFamilia),localStorage.setItem("UsuariosFamilia",i)}t.FamiliaPorAceptar&&t.FamiliaPorAceptar.length>=0&&localStorage.setItem("FAMILIA-POR-ACEPTAR",JSON.stringify(t.FamiliaPorAceptar)),t.FamiliaAceptada&&t.FamiliaAceptada.length>=0&&localStorage.setItem("FAMILIA-ACEPTADA",JSON.stringify(t.FamiliaAceptada)),t.FamiliaRechazada&&t.FamiliaRechazada.length>=0&&localStorage.setItem("FAMILIA-RECHAZADA",JSON.stringify(t.FamiliaRechazada)),this.CodigoMensaje=t.RespuestaBase.CodigoMensaje,this.Mensaje=t.RespuestaBase.Mensaje,this.loggedIn=!0}},{key:"irAHome",value:function(){this.navCtrl.navigateRoot("home")}}]),t}()).\u0275fac=function(t){return new(t||b)(c.Qb(o.Z),c.Qb(o.gb),c.Qb(o.Y),c.Qb(o.bb),c.Qb(o.X),c.Qb(r.a),c.Qb(r.g),c.Qb(l.a),c.Qb(o.W),c.Qb(u.a),c.Qb(d.a),c.Qb(g.a),c.Qb(o.a))},b.\u0275cmp=c.Kb({type:b,selectors:[["app-quitar-familia"]],decls:10,vars:4,consts:[[1,"back-app"],["color","primary","mode","md"],["slot","start"],["defaultHref","/home",1,"fcw"],[1,"fcw"],[3,"mostrar","titulo"],[3,"hidden"],["style","padding-top: 24px;",4,"ngIf"],[2,"padding-top","24px"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","accent",1,"button-registrarse",3,"disabled","click"],["lines","inset"],["size","10"],[1,"text-integrante"],["size","2"],["mode","ios",3,"checked","ngModel","ngModelChange"]],template:function(t,e){1&t&&(c.Vb(0,"ion-header",0),c.Vb(1,"ion-toolbar",1),c.Vb(2,"ion-buttons",2),c.Rb(3,"ion-back-button",3),c.Ub(),c.Vb(4,"ion-title",4),c.zc(5,"Activar o desactivar integrantes"),c.Ub(),c.Ub(),c.Ub(),c.Vb(6,"ion-content",0),c.Rb(7,"app-progress",5),c.Vb(8,"div",6),c.yc(9,f,5,2,"div",7),c.Ub(),c.Ub()),2&t&&(c.Cb(7),c.jc("mostrar",e.estaCargando)("titulo",e.tituloProgress),c.Cb(1),c.jc("hidden",e.estaCargando),c.Cb(1),c.jc("ngIf",e.familiaAsociar.length>0))},directives:[o.u,o.T,o.i,o.e,o.f,o.R,o.p,m.a,a.k,a.j,o.K,h.b,o.z,o.t,o.o,o.S,o.b,s.k,s.n],styles:[".button-registrarse[_ngcontent-%COMP%]{margin-top:32px;width:90%;margin-left:5%}.text-integrante[_ngcontent-%COMP%]{font-size:16pt;color:rgba(0,0,0,.87);letter-spacing:.5pt;line-height:24pt}"]}),b),v=i("j1ZV"),I=i("kmnG"),U=i("d3UM"),R=i("qFsG"),O=i("NFeN"),S=((A=function t(){_classCallCheck(this,t)}).\u0275mod=c.Ob({type:A}),A.\u0275inj=c.Nb({factory:function(t){return new(t||A)},imports:[[a.c,s.g,I.e,U.b,R.c,h.c,O.b,o.U,v.a,r.j.forChild([{path:"",component:C}])]]}),A)}}]);