function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{hnZd:function(e,t,i){"use strict";i.r(t),i.d(t,"RegistroUnoPageModule",(function(){return q}));var o=i("ofXK"),r=i("3Pt+"),n=i("TEn/"),a=i("tyNb"),s=i("kmnG"),c=i("d3UM"),u=i("qFsG"),l=i("bTqV"),m=i("NFeN"),d=i("iadO"),b=i("fXoL");i("8LU1"),i("XNiG"),i("quSY"),i("0EQZ");var p,h=((p=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ob({type:p}),p.\u0275inj=b.Nb({factory:function(e){return new(e||p)}}),p),f=i("+rOU");i("u47x"),i("FtGj"),i("/uUt"),i("JX91"),i("pLZG"),i("IzEk"),i("EY2u"),i("VRyK"),i("R0Ic"),i("R1ws");var g,v=((g=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ob({type:g}),g.\u0275inj=b.Nb({factory:function(e){return new(e||g)},imports:[[o.c,h,f.e]]}),g),j=i("FKr1"),R=i("mrSG"),C=i("wd/R"),M=i("ymXj"),w=i("w9zE"),y=i("skLv"),A=i("70lJ");function U(e,t){1&e&&(b.Vb(0,"mat-error"),b.zc(1,"Run requerido"),b.Ub())}function k(e,t){1&e&&(b.Vb(0,"mat-error"),b.zc(1,"Rut inv\xe1lido"),b.Ub())}function E(e,t){1&e&&(b.Vb(0,"mat-error"),b.zc(1,"Fecha nac requerida"),b.Ub())}var N,O,V=function(e,t){return{"ion-no-padding":e,"ion-padding":t}},x=((N=function(){function e(t,i,o,r,n,a,s,c){var u=this;_classCallCheck(this,e),this.navCtrl=t,this.utiles=i,this.servicioGeo=o,this.parametros=r,this.loading=n,this.formBuilder=a,this.activatedRoute=s,this.router=c,this.nombre="",this.cargando=!1,this.expEmail=/^[^@\s]+@[^@\s]+\.[^@\s]+$/gm,this.tipoMovimiento="1",this.estaAgregandoFamilia=!1,this.paginaAnterior="inicio",this.muestraMensaje=!1,this.objetoMensaje={irA:"inicio",titulo:"",contenido:""},this.RunValidator=function(e){var t=e.get("run").value;return null!==t&&""!==t&&0==u.utiles.Rut(t)&&u.forma.controls.run.setErrors({runInvalido:!1}),null}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;C.locale("es"),this.activatedRoute.queryParams.subscribe((function(t){t&&t.estaAgregandoFamilia&&(e.estaAgregandoFamilia=!0),t&&t.nombre&&(e.nombre=t.nombre),t&&t.modulo&&(e.paginaAnterior=t.modulo)})),this.cargarForma()}},{key:"cargarForma",value:function(){this.forma=new r.e({run:new r.c("",[r.q.required]),email:new r.c("",[r.q.required,r.q.pattern(this.expEmail)]),fechaNacimiento:new r.c("",[r.q.required])},{validators:this.RunValidator})}},{key:"volver",value:function(){this.navCtrl.navigateRoot(["pre-registro-uno"],{queryParams:{modulo:"inicio",nombre:this.nombre}})}},{key:"verificaRegistroCompleto",value:function(){return Object(R.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,o,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.forma.invalid){e.next=2;break}return e.abrupt("return");case 2:return t=this.forma.controls.run.value,i=this.utiles.entregaIdDispositivo(),C(this.forma.controls.fechaNacimiento.value).format("DD-MM-YYYY"),this.cargando=!0,e.next=6,this.loading.create({message:"Verificando...<br>Registro",duration:3e3});case 6:return o=e.sent,e.next=9,o.present().then((function(){return Object(R.b)(r,void 0,void 0,regeneratorRuntime.mark((function e(){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.getRegistroAppNativeRun(t,i).then((function(e){var t=JSON.parse(e.data);r.procesarRespuestaRegistroCompleto(t,o)}),(function(e){r.utiles.presentToast("Ocurri\xf3 un error de obtenci\xf3n identificador","bottom",4e3),o.dismiss()})):this.servicioGeo.getRegistroAppRun(t,i).subscribe((function(e){r.procesarRespuestaRegistroCompleto(e,o)}));case 1:case"end":return e.stop()}}),e,this)})))}));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"verificaRegistro",value:function(){return Object(R.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,o,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.forma.controls.run,i=this.utiles.entregaIdDispositivo(),this.cargando=!0,e.next=4,this.loading.create({message:"Verificando...<br>Registro",duration:3e3});case 4:return o=e.sent,e.next=7,o.present().then((function(){return Object(R.b)(r,void 0,void 0,regeneratorRuntime.mark((function e(){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.getRegistroAppNativeRun(t.value,i).then((function(e){var t=JSON.parse(e.data);r.procesarRespuestaRegistro(t,o)}),(function(e){r.utiles.presentToast("Ocurri\xf3 un error de obtenci\xf3n identificador","bottom",4e3),o.dismiss()})):this.servicioGeo.getRegistroAppRun(t.value,i).subscribe((function(e){r.procesarRespuestaRegistro(e,o)}));case 1:case"end":return e.stop()}}),e,this)})))}));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"abrirLogin",value:function(){this.navCtrl.navigateRoot("nuevo-login")}},{key:"procesarRespuestaRegistroCompleto",value:function(e,t){e&&null!=e?null!=e.CorreoElectronico&&""!=e.CorreoElectronico&&null!=e.CorreoElectronico&&null!=e.Password&&""!=e.Password&&null!=e.Password&&null!=e.Run&&""!=e.Run&&null!=e.Run&&null!=e.NombreUsuario&&""!=e.NombreUsuario&&null!=e.NombreUsuario?(this.utiles.presentToast("Usted ya tiene registro","middle",5e3),t.dismiss(),0==this.estaAgregandoFamilia&&this.abrirLogin()):(this.registroIncompleto=e,this.utiles.presentToast("Su registro est\xe1 incompleto","middle",5e3),t.dismiss(),this.irARegistro(this.estaAgregandoFamilia)):(t.dismiss(),this.verficarEnrolamientoRayenCompleto())}},{key:"procesarRespuestaRegistro",value:function(e,t){e&&null!=e?null!=e.CorreoElectronico&&""!=e.CorreoElectronico&&null!=e.CorreoElectronico&&null!=e.Password&&""!=e.Password&&null!=e.Password&&null!=e.Run&&""!=e.Run&&null!=e.Run&&null!=e.NombreUsuario&&""!=e.NombreUsuario&&null!=e.NombreUsuario?(this.utiles.presentToast("Usted ya tiene registro","middle",5e3),t.dismiss(),0==this.estaAgregandoFamilia&&this.abrirLogin()):(this.registroIncompleto=e,this.utiles.presentToast("Su registro est\xe1 incompleto","middle",5e3),t.dismiss(),this.irARegistro(this.estaAgregandoFamilia)):(t.dismiss(),this.verficarEnrolamientoRayen())}},{key:"irARegistro",value:function(e){var t;this.registroIncompleto&&(t={usuario:JSON.stringify(this.registroIncompleto),estaAgregandoFamilia:e},this.navCtrl.navigateRoot(["registro-usuario"],{queryParams:t}))}},{key:"irAClaveUnica",value:function(){var e=this.forma.controls.run.value,t=C().format("DD-MM-YYYY HH:mm"),i=this.utiles.encriptar(e+"|"+t+"|"+this.tipoMovimiento);localStorage.setItem("STATE_CLAVE_UNICA",i),this.navCtrl.navigateRoot(["login-clave-unica"],{queryParams:{state:i}})}},{key:"verficarEnrolamientoRayen",value:function(){return Object(R.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.forma.controls.run,this.cargando=!0,e.next=4,this.loading.create({message:"Verificando...<br>Registro",duration:3e3});case 4:return i=e.sent,e.next=7,i.present().then((function(){return Object(R.b)(o,void 0,void 0,regeneratorRuntime.mark((function e(){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.verificaEnrolamientoNative(t.value).then((function(e){var t=JSON.parse(e.data);o.procesaRespuestaEnrolamiento(t,i)}),(function(e){o.utiles.presentToast("Ocurri\xf3 un error de obtenci\xf3n identificador","bottom",4e3),i.dismiss()})):this.servicioGeo.verificaEnrolamiento(t.value).subscribe((function(e){o.procesaRespuestaEnrolamiento(e,i)}));case 1:case"end":return e.stop()}}),e,this)})))}));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"verficarEnrolamientoRayenCompleto",value:function(){return Object(R.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,o,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.forma.controls.run.value,i=C(this.forma.controls.fechaNacimiento.value).format("DD-MM-YYYY"),o=this.forma.controls.email.value,this.cargando=!0,e.next=4,this.loading.create({message:"Verificando...<br>Registro",duration:3e3});case 4:return r=e.sent,e.next=7,r.present().then((function(){return Object(R.b)(n,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.utiles.isAppOnDevice()?this.servicioGeo.verificaEnrolamientoCompletoNative(t,i,o).then((function(e){var t=JSON.parse(e.data);n.procesaRespuestaEnrolamiento(t,r)}),(function(e){n.utiles.presentToast("Ocurri\xf3 un error de obtenci\xf3n identificador","bottom",4e3),r.dismiss()})):this.servicioGeo.verificaEnrolamientoCompleto(t,i,o).subscribe((function(e){n.procesaRespuestaEnrolamiento(e,r)}));case 1:case"end":return e.stop()}}),e,this)})))}));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"procesaRespuestaEnrolamiento",value:function(e,t){if(0==e.RespuestaBase.CodigoMensaje){var i=e.PreRegistro;t.dismiss(),this.muestraMensaje=!0,this.objetoMensaje.irA="inicio",this.objetoMensaje.titulo="Registro en la app mi familia",this.objetoMensaje.contenido=e.RespuestaBase.Mensaje,localStorage.setItem("PRE-REGISTRO",JSON.stringify(i))}else t.dismiss(),this.parametros.USA_CLAVE_UNICA()?this.irAClaveUnica():(this.muestraMensaje=!0,8==e.RespuestaBase.CodigoMensaje?(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Menor de edad",this.objetoMensaje.contenido="No puedes registrarte ya que eres menor de edad y el registro para esta aplicaci\xf3n es s\xf3lo para mayores."):9==e.RespuestaBase.CodigoMensaje?(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Fecha nacimiento no coincide",this.objetoMensaje.contenido="La fecha de nacimiento ingresada no coincide con nuestros registros, rev\xedsela e int\xe9ntelo nuevamente."):10==e.RespuestaBase.CodigoMensaje?(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Email no coincide",this.objetoMensaje.contenido="El email ingresado no coincide con nuestros registros, rev\xedselo e int\xe9ntelo nuevamente."):11==e.RespuestaBase.CodigoMensaje?(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Sin datos de contacto",this.objetoMensaje.contenido="No cuentas con datos de contacto, te sugerimos actualizarlos en tu centro de salud."):12==e.RespuestaBase.CodigoMensaje?(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Establecimiento sin permisos",this.objetoMensaje.contenido="El establecimiento en el cual te encuentras inscrito no tiene permisos para usar la aplicacion."):1==e.RespuestaBase.CodigoMensaje?(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Run no encontrado",this.objetoMensaje.contenido="Por el momento no cuentas con registros de salud en la Red p\xfablica, el run digitado no ha sido encontrado."):(this.objetoMensaje.irA=this.paginaAnterior,this.objetoMensaje.titulo="Mensaje",this.objetoMensaje.contenido=e.RespuestaBase.Mensaje))}},{key:"f",get:function(){return this.forma.controls}}]),e}()).\u0275fac=function(e){return new(e||N)(b.Qb(n.Z),b.Qb(M.a),b.Qb(w.a),b.Qb(y.a),b.Qb(n.W),b.Qb(r.b),b.Qb(a.a),b.Qb(a.g))},N.\u0275cmp=b.Kb({type:N,selectors:[["app-registro-uno"]],decls:47,vars:20,consts:[[3,"ngClass"],[1,"mt-24",3,"hidden"],["mat-icon-button","","aria-label","Example icon-button with a heart icon",3,"click"],[3,"hidden"],[1,"mt-16"],[1,"texto-1"],["novalidate","",3,"formGroup"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","12535301-1","formControlName","run","name","run","required",""],[4,"ngIf"],["matInput","","formControlName","fechaNacimiento","name","fechaNacimiento","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["datepicker",""],["matInput","","placeholder","ejemplo@gmail.com","formControlName","email","name","email","required",""],[1,"mt-24"],["mat-flat-button","","color","primary",2,"width","90%","margin-left","5%",3,"disabled","click"],[3,"titulo","contenido","irA"]],template:function(e,t){if(1&e&&(b.Vb(0,"ion-content",0),b.Vb(1,"ion-row",1),b.Vb(2,"button",2),b.dc("click",(function(){return t.volver()})),b.Vb(3,"mat-icon"),b.zc(4,"arrow_back_ios"),b.Ub(),b.Ub(),b.Ub(),b.Vb(5,"div",3),b.Vb(6,"ion-row",4),b.Vb(7,"h1"),b.zc(8),b.Ub(),b.Ub(),b.Vb(9,"ion-row"),b.Vb(10,"p",5),b.zc(11,"A continuaci\xf3n procederemos a verificar si ya tienes cuenta activa y existen datos cl\xednicos, para esto necesitamos que ingreses tu RUN, fecha de nacimiento y correo electr\xf3nico, la direcci\xf3n de"),b.Vb(12,"strong"),b.zc(13," correo electr\xf3nico debe ser la registrada al momento de inscribirte en tu Centro de salud."),b.Ub(),b.Rb(14,"br"),b.zc(15," Existe la posibilidad de validar con clave \xfanica, siempre y cuando tu Establecimiento tenga habilitado dicho servicio. "),b.Ub(),b.Ub(),b.Vb(16,"form",6),b.Vb(17,"ion-row",4),b.Vb(18,"mat-form-field",7),b.Vb(19,"mat-label"),b.zc(20,"Run (Sin puntos y con gui\xf3n)"),b.Ub(),b.Rb(21,"input",8),b.yc(22,U,2,0,"mat-error",9),b.yc(23,k,2,0,"mat-error",9),b.Ub(),b.Ub(),b.Vb(24,"ion-row"),b.Vb(25,"mat-form-field",7),b.Vb(26,"mat-label"),b.zc(27,"Seleccione fecha nacimiento"),b.Ub(),b.Rb(28,"input",10),b.Rb(29,"mat-datepicker-toggle",11),b.Rb(30,"mat-datepicker",null,12),b.yc(32,E,2,0,"mat-error",9),b.Ub(),b.Ub(),b.Vb(33,"ion-row"),b.Vb(34,"mat-form-field",7),b.Vb(35,"mat-label"),b.zc(36,"Correo electr\xf3nico"),b.Ub(),b.Rb(37,"input",13),b.Vb(38,"mat-error",3),b.zc(39,"Correo requerido"),b.Ub(),b.Vb(40,"mat-error",3),b.zc(41,"Correo inv\xe1lido"),b.Ub(),b.Ub(),b.Ub(),b.Vb(42,"ion-row",14),b.Vb(43,"button",15),b.dc("click",(function(){return t.verificaRegistroCompleto()})),b.zc(44,"CONTINUAR"),b.Ub(),b.Ub(),b.Ub(),b.Ub(),b.Vb(45,"div",3),b.Rb(46,"app-pagina-mensajes",16),b.Ub(),b.Ub()),2&e){var i=b.qc(31);b.jc("ngClass",b.oc(17,V,t.muestraMensaje,0==t.muestraMensaje)),b.Cb(1),b.jc("hidden",t.muestraMensaje),b.Cb(4),b.jc("hidden",t.muestraMensaje),b.Cb(3),b.Bc("Hola, ",t.nombre,", un gusto en conocerte"),b.Cb(8),b.jc("formGroup",t.forma),b.Cb(6),b.jc("ngIf",t.f.run.errors&&t.f.run.errors.required),b.Cb(1),b.jc("ngIf",t.f.run.errors&&0==t.f.run.errors.runInvalido),b.Cb(5),b.jc("matDatepicker",i),b.Cb(1),b.jc("for",i),b.Cb(3),b.jc("ngIf",t.f.fechaNacimiento.errors&&t.f.fechaNacimiento.errors.required),b.Cb(6),b.jc("hidden",!(t.f.email.errors&&t.f.email.errors.required)),b.Cb(2),b.jc("hidden",!(t.f.email.errors&&t.f.email.errors.pattern)),b.Cb(3),b.jc("disabled",t.forma.invalid),b.Cb(2),b.jc("hidden",!t.muestraMensaje),b.Cb(1),b.jc("titulo",t.objetoMensaje.titulo)("contenido",t.objetoMensaje.contenido)("irA",t.objetoMensaje.irA)}},directives:[n.p,o.i,n.K,l.b,m.a,r.r,r.l,r.f,s.c,s.g,u.b,r.a,r.k,r.d,r.p,o.k,d.b,d.d,s.h,d.a,s.b,A.a],styles:[".mt-16[_ngcontent-%COMP%]{margin-top:16px}.mt-32[_ngcontent-%COMP%]{margin-top:32px}.mt-24[_ngcontent-%COMP%]{margin-top:24px}.mt-80[_ngcontent-%COMP%]{margin-top:5em}.mt-40[_ngcontent-%COMP%]{margin-top:2.5em}.mt-36[_ngcontent-%COMP%]{margin-top:2.25em}.mt-52[_ngcontent-%COMP%]{margin-top:3.25em}.texto-1[_ngcontent-%COMP%]{font-size:1.2em;color:#575657}"]}),N),P=i("j1ZV"),q=((O=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ob({type:O}),O.\u0275inj=b.Nb({factory:function(e){return new(e||O)},imports:[[o.c,r.g,r.o,n.U,s.e,c.b,u.c,l.c,m.b,d.c,v,j.h,P.a,a.j.forChild([{path:"",component:x}])]]}),O)}}]);