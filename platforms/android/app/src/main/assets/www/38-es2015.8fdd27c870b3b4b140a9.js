(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{vOkq:function(i,s,t){"use strict";t.r(s),t.d(s,"AjustesFamiliaPageModule",(function(){return f}));var e=t("ofXK"),a=t("3Pt+"),o=t("TEn/"),r=t("tyNb"),n=t("mrSG"),l=t("AytR"),u=t("fXoL"),c=t("ymXj"),g=t("qSmr");function m(i,s){if(1&i&&u.Rb(0,"img",8),2&i){const i=u.gc();u.jc("src",i.image,u.sc)}}function h(i,s){if(1&i){const i=u.Wb();u.Vb(0,"ion-list",9),u.Vb(1,"ion-item"),u.Vb(2,"ion-note",10),u.zc(3,"Seleccione el archivo"),u.Ub(),u.Ub(),u.Vb(4,"ion-item"),u.Vb(5,"ion-input",11),u.dc("change",(function(s){return u.rc(i),u.gc().changeListener(s)})),u.Ub(),u.Ub(),u.Ub()}}function p(i,s){1&i&&(u.Vb(0,"ion-item"),u.zc(1," No puede editar ya que no se encuentra registrado "),u.Ub())}let b=(()=>{class i{constructor(i,s,t,e,a,o,r,n,l,u){this.modalCtrl=i,this.utiles=s,this.navCtrl=t,this.toast=e,this.platform=a,this.menu=o,this.loading=r,this.img=n,this.activatedRoute=l,this.router=u,this.image=null,this.lastImage=null,this.nombrePaciente="",this.color="#127bdc",this.miColor="#FF4081",this.tieneRegistro=!1}ngOnInit(){localStorage.getItem("TIENE_REGISTRO")&&"true"==localStorage.getItem("TIENE_REGISTRO").toLowerCase()&&(this.tieneRegistro=!0),this.activatedRoute.queryParams.subscribe(i=>{i&&i.usuario&&(this.usuarioAps=JSON.parse(i.usuario),this.image=this.usuarioAps.UrlImagen,this.miColor=this.utiles.entregaColor(this.usuarioAps),this.color=this.miColor,this.nombrePaciente=this.usuarioAps.Nombres+" "+this.usuarioAps.ApellidoPaterno+" "+this.usuarioAps.ApellidoMaterno)})}setColor(i){this.color=i}changeListener(i){this.fileP=i.target.files[0],this.fileP?this.fileP.size<=2048e3?this.putImagen(this.fileP):this.utiles.presentToast("El tama\xf1o de la im\xe1gen excede el m\xe1ximo permitido.","center",3e3):this.utiles.presentToast("No ha seleccionado ninguna im\xe1gen v\xe1lida.","center",3e3)}putImagen(i){return Object(n.b)(this,void 0,void 0,(function*(){var s=this.usuarioAps.Id.toString();let t=yield this.loading.create({message:"Guardando...<br>Imagen del usuario.",duration:2e4});yield t.present().then(()=>Object(n.b)(this,void 0,void 0,(function*(){this.utiles.isAppOnDevice()?this.img.putImagenNative(s,i).then(i=>{if(i&&(this.image=l.a.URL_FOTOS+JSON.parse(i.data),this.usuarioAps&&this.usuarioAps.UrlImagen&&(this.usuarioAps.UrlImagen=l.a.URL_FOTOS+JSON.parse(i.data)),sessionStorage.UsuarioAps)){var e=JSON.parse(sessionStorage.UsuarioAps);if(e.Id==s)e.UrlImagen=JSON.parse(i.data),sessionStorage.setItem("UsuarioAps",JSON.stringify(e));else{var a=JSON.parse(localStorage.getItem("UsuariosFamilia"));a&&a.length>0&&(a.forEach(t=>{t.Id==s&&(t.UrlImagen=JSON.parse(i.data))}),localStorage.setItem("UsuariosFamilia",JSON.stringify(a)))}}t.dismiss()}):this.img.putImagen(s,i).subscribe(i=>{if(i&&(this.image=l.a.URL_FOTOS+i,this.usuarioAps&&this.usuarioAps.UrlImagen&&(this.usuarioAps.UrlImagen=l.a.URL_FOTOS+i),sessionStorage.UsuarioAps)){var e=JSON.parse(sessionStorage.UsuarioAps);if(e.Id==s)e.UrlImagen=i,sessionStorage.setItem("UsuarioAps",JSON.stringify(e));else{var a=JSON.parse(localStorage.getItem("UsuariosFamilia"));a&&a.length>0&&(a.forEach(t=>{t.Id==s&&(t.UrlImagen=i)}),localStorage.setItem("UsuariosFamilia",JSON.stringify(a)))}}t.dismiss()})})))}))}putColor(){return Object(n.b)(this,void 0,void 0,(function*(){var i=this.usuarioAps.Id.toString(),s=this.color;let t=yield this.loading.create({message:"Guardando...<br>Color del usuario.",duration:2e4});yield t.present().then(()=>Object(n.b)(this,void 0,void 0,(function*(){this.utiles.isAppOnDevice()?this.img.putColorNative(i,s).then(s=>{if(s&&(this.utiles.cambiaColorLocalStorage(JSON.parse(s.data)),this.color=JSON.parse(s.data),this.usuarioAps&&this.usuarioAps.Color&&(this.usuarioAps.Color=JSON.parse(s.data)),sessionStorage.UsuarioAps)){var e=JSON.parse(sessionStorage.UsuarioAps);if(e.Id==i)e.Color=JSON.parse(s.data),sessionStorage.setItem("UsuarioAps",JSON.stringify(e));else{var a=JSON.parse(localStorage.getItem("UsuariosFamilia"));a&&a.length>0&&(a.forEach(t=>{t.Id==i&&(t.Color=JSON.parse(s.data))}),localStorage.setItem("UsuariosFamilia",JSON.stringify(a)))}}t.dismiss()},i=>{t.dismiss(),this.utiles.presentToast(i,"bottom",4e3)}):this.img.putColor(i,s).subscribe(s=>{if(s){if(this.color=s,this.usuarioAps&&this.usuarioAps.Color&&(this.usuarioAps.Color=s),sessionStorage.UsuarioAps){var e=JSON.parse(sessionStorage.UsuarioAps);if(e.Id==i)e.Color=s,sessionStorage.setItem("UsuarioAps",JSON.stringify(e));else{var a=JSON.parse(localStorage.getItem("UsuariosFamilia"));a&&a.length>0&&(a.forEach(t=>{t.Id==i&&(t.Color=s)}),localStorage.setItem("UsuariosFamilia",JSON.stringify(a)))}}localStorage.setItem("MI_COLOR",s)}t.dismiss()})})))}))}abrirEditar(){let i={usuario:null};i={usuario:JSON.stringify(this.usuarioAps)},this.navCtrl.navigateRoot(["contactabilidad"],{queryParams:i})}}return i.\u0275fac=function(s){return new(s||i)(u.Qb(o.Y),u.Qb(c.a),u.Qb(o.Z),u.Qb(o.gb),u.Qb(o.bb),u.Qb(o.X),u.Qb(o.W),u.Qb(g.a),u.Qb(r.a),u.Qb(r.g))},i.\u0275cmp=u.Kb({type:i,selectors:[["app-ajustes-familia"]],decls:16,vars:4,consts:[[1,"back-app"],["color","primary","mode","md"],["slot","start"],["defaultHref","/familia",1,"fcw"],[1,"fcw"],[3,"src",4,"ngIf"],["lines","none",4,"ngIf"],[4,"ngIf"],[3,"src"],["lines","none"],["id","profile_image","color","primary"],["type","file","accept","image/*",3,"change"]],template:function(i,s){1&i&&(u.Vb(0,"ion-header",0),u.Vb(1,"ion-toolbar",1),u.Vb(2,"ion-buttons",2),u.Rb(3,"ion-back-button",3),u.Ub(),u.Vb(4,"ion-title",4),u.zc(5),u.Ub(),u.Ub(),u.Ub(),u.Vb(6,"ion-content",0),u.Vb(7,"ion-card"),u.Vb(8,"ion-card-header"),u.Vb(9,"ion-card-title"),u.zc(10,"Mi imagen"),u.Ub(),u.Ub(),u.Vb(11,"ion-card-content"),u.Vb(12,"div"),u.yc(13,m,1,1,"img",5),u.Ub(),u.Ub(),u.Ub(),u.yc(14,h,6,0,"ion-list",6),u.yc(15,p,2,0,"ion-item",7),u.Ub()),2&i&&(u.Cb(5),u.Bc("Ajustes ",s.nombrePaciente,""),u.Cb(8),u.jc("ngIf",s.image),u.Cb(1),u.jc("ngIf",s.tieneRegistro),u.Cb(1),u.jc("ngIf",!s.tieneRegistro))},directives:[o.u,o.T,o.i,o.e,o.f,o.R,o.p,o.j,o.l,o.n,o.k,e.k,o.B,o.z,o.F,o.y,o.fb],styles:[""]}),i})();var d=t("j1ZV");let f=(()=>{class i{}return i.\u0275mod=u.Ob({type:i}),i.\u0275inj=u.Nb({factory:function(s){return new(s||i)},imports:[[e.c,a.g,o.U,d.a,r.j.forChild([{path:"",component:b}])]]}),i})()}}]);