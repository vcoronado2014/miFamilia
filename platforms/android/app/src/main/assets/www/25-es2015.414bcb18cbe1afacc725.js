(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"1VCC":function(t,o,s){"use strict";s.d(o,"a",(function(){return a}));var i=s("fXoL"),e=s("TEn/");let a=(()=>{class t{constructor(){this.mostrar=!1}ngOnInit(){}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=i.Kb({type:t,selectors:[["app-progress"]],inputs:{mostrar:"mostrar",titulo:"titulo"},decls:4,vars:2,consts:[[1,"centrado",3,"hidden"],[1,"titulo-item-2"],["type","indeterminate",1,"ion-margin-top"]],template:function(t,o){1&t&&(i.Vb(0,"div",0),i.Vb(1,"ion-label",1),i.zc(2),i.Ub(),i.Rb(3,"ion-progress-bar",2),i.Ub()),2&t&&(i.jc("hidden",!o.mostrar),i.Cb(2),i.Ac(o.titulo))},directives:[e.A,e.G],styles:[".centrado[_ngcontent-%COMP%]{text-align:center;width:100%;height:10%;position:absolute;top:45%;padding-left:60px;padding-right:60px}.titulo-item-2[_ngcontent-%COMP%]{font-size:16px;color:rgba(0,0,0,.87)}"]}),t})()},TPni:function(t,o,s){"use strict";s.r(o),s.d(o,"ContactabilidadPageModule",(function(){return O}));var i=s("ofXK"),e=s("3Pt+"),a=s("TEn/"),r=s("tyNb"),n=s("kmnG"),l=s("d3UM"),c=s("qFsG"),d=s("bTqV"),m=s("NFeN"),u=s("mrSG"),g=s("wd/R"),h=s("fXoL"),b=s("ymXj"),p=s("w9zE"),f=s("Li8n"),C=s("skLv"),A=s("1VCC");function I(t,o){if(1&t&&h.Rb(0,"img",20),2&t){const t=h.gc();h.kc("src",t.usuarioAps.UrlImagen,h.sc)}}function R(t,o){1&t&&h.Rb(0,"img",21)}let v=(()=>{class t{constructor(t,o,s,i,e,a,r,n,l,c){this.navCtrl=t,this.utiles=o,this.servicioGeo=s,this.loading=i,this.formBuilder=e,this.activatedRoute=a,this.router=r,this.acceso=n,this.parametrosApp=l,this.alertController=c,this.patternOnlyLetter="[a-zA-Z\xc0-\xff\xf1\xd1]+(s*[a-zA-Z\xc0-\xff\xf1\xd1]*)*[a-zA-Z\xc0-\xff\xf1\xd1 ]+$",this.expCelular=/^(\+?56)?(\s?)(0?9)(\s?)[9876543]\d{7}$/gm,this.expPassword=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{4,8}$/gm,this.expEmail=/^[^@\s]+@[^@\s]+\.[^@\s]+$/gm,this.registro=null,this.estaCargando=!1,this.tituloProgress="",this.usuarioAps=null,this.usuarioApsRegistro=null,this.modificaRegistro=!1,this.nombrePersona=""}ngOnInit(){g.locale("es"),this.activatedRoute.queryParams.subscribe(t=>{t&&t.usuario&&(localStorage.getItem("REGISTRO")&&(this.registro=JSON.parse(localStorage.getItem("REGISTRO"))),this.usuarioAps=JSON.parse(t.usuario),this.nombrePersona=this.usuarioAps.Nombres+" "+this.usuarioAps.ApellidoPaterno,localStorage.getItem("UsuarioAps")&&(this.usuarioApsRegistro=JSON.parse(localStorage.getItem("UsuarioAps"))),this.usuarioAps&&this.usuarioApsRegistro&&this.registro&&this.usuarioAps.Id==this.usuarioApsRegistro.Id&&(this.modificaRegistro=!0))}),this.cargarForma()}cargarForma(){this.forma=new e.e({nombreSocial:new e.c(""),email:new e.c("",[e.q.pattern(this.expEmail)]),telefono:new e.c("",[e.q.pattern(this.expCelular)])}),this.modificaRegistro?this.registro&&null!=this.registro&&this.forma.setValue({nombreSocial:this.registro.Apodo,email:this.registro.CorreoElectronico,telefono:this.registro.TelefonoContacto?this.registro.TelefonoContacto:""}):null!=this.usuarioAps.Contactabilidad&&this.forma.setValue({nombreSocial:this.usuarioAps.Contactabilidad.NombreSocial,email:this.usuarioAps.Contactabilidad.Email,telefono:this.usuarioAps.Contactabilidad.Telefono?this.usuarioAps.Contactabilidad.Telefono:""})}onSumbit(){return Object(u.b)(this,void 0,void 0,(function*(){if(this.parametrosApp.USA_API_MANAGEMENT()){let t=yield this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null,duration:2e3});this.estaCargando=!0,this.tituloProgress="Actualizando datos de contacto";let o=this.forma.controls.email?this.forma.controls.email.value:"",s=this.forma.controls.nombreSocial?this.forma.controls.nombreSocial.value:"",i=this.forma.controls.telefono?this.forma.controls.telefono.value:"",e=this.usuarioAps.Rut;yield t.present().then(()=>Object(u.b)(this,void 0,void 0,(function*(){this.utiles.isAppOnDevice()?this.servicioGeo.postInformarPersonaNative(e,s,o,i,"MOVIL_FICHA_FAMILIAR").then(a=>{var r=JSON.parse(a.data);this.procesarRespuesta(r,t,s,i,o,e)}).catch(o=>{console.log(o.message),this.estaCargando=!1,t.dismiss(),this.tituloProgress="",this.utiles.presentToast("Se present\xf3 un error al guardar los datos, contacte al administrador","bottom",2e3)}):this.servicioGeo.postInformarPersona(e,s,o,i,"MOVIL_FICHA_FAMILIAR").subscribe(a=>{this.procesarRespuesta(a,t,s,i,o,e)},o=>{console.log(o.message),this.estaCargando=!1,t.dismiss(),this.tituloProgress="",this.utiles.presentToast("Se present\xf3 un error al guardar los datos, contacte al administrador","bottom",2e3)})})))}else this.utiles.presentToast("Esta funcionalidad no est\xe1 disponible","bottom",3e3)}))}procesarRespuesta(t,o,s,i,e,a){return Object(u.b)(this,void 0,void 0,(function*(){if(t)if(t.InformarPersonaResponse)if(t.InformarPersonaResponse.RespuestaBase){let e=!1,r=!1;t.InformarPersonaResponse.RespuestaBase.Rayen&&"TRANSACCI\xd3N EXITOSA"==t.InformarPersonaResponse.RespuestaBase.Rayen.Descripcion.toUpperCase()&&(e=!0),t.InformarPersonaResponse.RespuestaBase.Ryf&&"TRANSACCI\xd3N EXITOSA"==t.InformarPersonaResponse.RespuestaBase.Ryf.Descripcion.toUpperCase()&&(r=!0),r||e?(this.estaCargando=!1,this.tituloProgress="",o.dismiss(),this.utiles.presentToast("Datos actualizados correctamente","bottom",2e3),this.modificaRegistro&&this.actualizarRegistro(s,i),this.obtenerContactabilidad(a)):(this.estaCargando=!1,o.dismiss(),this.tituloProgress="",this.utiles.presentToast("Error al actualizar los datos","bottom",2e3))}else this.estaCargando=!1,o.dismiss(),this.tituloProgress="",this.utiles.presentToast("Error al actualizar los datos","bottom",3e3);else this.estaCargando=!1,o.dismiss(),this.tituloProgress="",this.utiles.presentToast("Error al actualizar los datos","bottom",3e3);else this.estaCargando=!1,o.dismiss(),this.utiles.presentToast("Error al actualizar los datos","bottom",3e3),this.tituloProgress=""}))}actualizarRegistro(t,o){return Object(u.b)(this,void 0,void 0,(function*(){var s=g();this.registro.FechaNacimiento&&(s=g(this.registro.FechaNacimiento)),this.registro.Apodo=t,this.registro.TelefonoContacto=o,this.registro.Id=this.registro.Id.toString(),this.registro.Activo=this.registro.Activo.toString(),this.registro.DiaNacimiento=s.date().toString(),this.registro.MesNacimiento=(s.month()+1).toString(),this.registro.AnioNacimiento=s.year().toString(),this.registro.Eliminado=this.registro.Eliminado.toString(),this.registro.ModoRegistro=this.registro.ModoRegistro.toString(),this.registro.FechaBaja=null;let i=yield this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});this.estaCargando=!0,this.tituloProgress="Actualizando datos de registro",yield i.present().then(()=>Object(u.b)(this,void 0,void 0,(function*(){this.utiles.isAppOnDevice()?this.servicioGeo.postRegistroFamiliaNative(this.registro).then(t=>{let o=JSON.parse(t.data);localStorage.setItem("REGISTRO",JSON.stringify(o)),i.dismiss(),this.estaCargando=!1,this.utiles.presentToast("Datos actualizados correctamente","bottom",2e3)}).catch(t=>{i.dismiss(),this.estaCargando=!1,this.utiles.presentToast(t,"bottom",2e3)}):this.servicioGeo.postRegistroFamilia(this.registro).subscribe(t=>{localStorage.setItem("REGISTRO",JSON.stringify(t)),i.dismiss(),this.estaCargando=!1,this.utiles.presentToast("Datos actualizados correctamente","bottom",2e3)},t=>{i.dismiss(),this.estaCargando=!1,this.utiles.presentToast(t,"bottom",2e3)})})))}))}actualizarContactabilidad(t,o,s,i){var e={Rut:t.Rut,Id:t.Id,NombreSocial:o,Telefono:s,Email:i,EtiquetaTelefono:"MOVIL_FICHA_FAMILIAR"};if(localStorage.getItem("UsuarioAps")){var a=JSON.parse(localStorage.getItem("UsuarioAps"));a&&a.Id==t.Id&&(a.Contactabilidad=e,localStorage.setItem("UsuarioAps",JSON.stringify(a)))}if(localStorage.getItem("UsuariosFamilia")){var r=!1,n=JSON.parse(localStorage.getItem("UsuariosFamilia"));if(n&&n.length>0)for(var l=0;l<n.length;l++)n[l].Id==t.Id&&(n[l].Contactabilidad=e,r=!0);r&&localStorage.setItem("UsuariosFamilia",JSON.stringify(n))}}obtenerContactabilidad(t){return Object(u.b)(this,void 0,void 0,(function*(){let o=yield this.loading.create({cssClass:"loading-vacio",showBackdrop:!1,spinner:null});this.estaCargando=!0,this.tituloProgress="Buscando contactabilidad",yield o.present().then(()=>Object(u.b)(this,void 0,void 0,(function*(){this.utiles.isAppOnDevice()?this.servicioGeo.getContactabilidadNative(t).then(t=>{let s=JSON.parse(t.data);o.dismiss(),this.estaCargando=!1,this.utiles.actualizarContactabilidad(s)}).catch(t=>{o.dismiss(),this.estaCargando=!1,this.utiles.presentToast(t,"bottom",2e3)}):this.servicioGeo.getContactabilidad(t).subscribe(t=>{let s=t;o.dismiss(),this.estaCargando=!1,this.utiles.actualizarContactabilidad(s)},t=>{o.dismiss(),this.estaCargando=!1,this.utiles.presentToast(t,"bottom",2e3)})})))}))}get f(){return this.forma.controls}}return t.\u0275fac=function(o){return new(o||t)(h.Qb(a.Z),h.Qb(b.a),h.Qb(p.a),h.Qb(a.W),h.Qb(e.b),h.Qb(r.a),h.Qb(r.g),h.Qb(f.a),h.Qb(C.a),h.Qb(a.a))},t.\u0275cmp=h.Kb({type:t,selectors:[["app-contactabilidad"]],decls:40,vars:9,consts:[[1,"back-app"],["color","primary","mode","md"],["slot","start"],["defaultHref","/familia",1,"fcw"],[1,"fcw"],[3,"mostrar","titulo"],[1,"ion-padding",2,"margin-top","15px",3,"hidden"],["novalidate","",3,"formGroup"],["lines","none",2,"--ion-item-background","transparent","--padding-start","0px"],["slot","start",2,"margin-top","-10px"],[3,"src",4,"ngIf"],["src","../assets/img/no-imagen.jpg",4,"ngIf"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Nombre social","formControlName","nombreSocial","name","nombreSocial"],["align","start"],[1,"mt-40"],["matInput","","placeholder","ejemplo@gmail.com","formControlName","email","name","email"],[3,"hidden"],["matInput","","placeholder","9XXXXXXXX","formControlName","telefono","name","telefono"],["mat-raised-button","","color","accent",1,"button-registrarse",3,"disabled","click"],[3,"src"],["src","../assets/img/no-imagen.jpg"]],template:function(t,o){1&t&&(h.Vb(0,"ion-header",0),h.Vb(1,"ion-toolbar",1),h.Vb(2,"ion-buttons",2),h.Rb(3,"ion-back-button",3),h.Ub(),h.Vb(4,"ion-title",4),h.zc(5,"Configurar integrante"),h.Ub(),h.Ub(),h.Ub(),h.Vb(6,"ion-content"),h.Rb(7,"app-progress",5),h.Vb(8,"div",6),h.Vb(9,"form",7),h.Vb(10,"ion-item",8),h.Vb(11,"ion-avatar",9),h.yc(12,I,1,1,"img",10),h.yc(13,R,1,0,"img",11),h.Ub(),h.Vb(14,"mat-form-field",12),h.Vb(15,"mat-label"),h.zc(16,"Nombre social"),h.Ub(),h.Rb(17,"input",13),h.Vb(18,"mat-hint",14),h.Vb(19,"strong"),h.zc(20,"Nombre por el cual te sientes identificado"),h.Ub(),h.Ub(),h.Ub(),h.Ub(),h.Vb(21,"h3",15),h.zc(22,"Datos de contacto"),h.Ub(),h.Vb(23,"ion-row"),h.Vb(24,"mat-form-field",12),h.Vb(25,"mat-label"),h.zc(26,"Correo electr\xf3nico"),h.Ub(),h.Rb(27,"input",16),h.Vb(28,"mat-error",17),h.zc(29,"Correo inv\xe1lido"),h.Ub(),h.Ub(),h.Ub(),h.Vb(30,"ion-row"),h.Vb(31,"mat-form-field",12),h.Vb(32,"mat-label"),h.zc(33,"Tel\xe9fono"),h.Ub(),h.Rb(34,"input",18),h.Vb(35,"mat-error",17),h.zc(36,"Tel\xe9fono inv\xe1lido"),h.Ub(),h.Ub(),h.Ub(),h.Vb(37,"ion-row"),h.Vb(38,"button",19),h.dc("click",(function(){return o.onSumbit()})),h.zc(39,"GUARDAR"),h.Ub(),h.Ub(),h.Ub(),h.Ub(),h.Ub()),2&t&&(h.Cb(7),h.jc("mostrar",o.estaCargando)("titulo",o.tituloProgress),h.Cb(1),h.jc("hidden",o.estaCargando),h.Cb(1),h.jc("formGroup",o.forma),h.Cb(3),h.jc("ngIf",""!=o.usuarioAps.UrlImagen),h.Cb(1),h.jc("ngIf",""==o.usuarioAps.UrlImagen),h.Cb(15),h.jc("hidden",!(o.f.email.errors&&o.f.email.errors.pattern)),h.Cb(7),h.jc("hidden",!(o.f.telefono.errors&&o.f.telefono.errors.pattern)),h.Cb(3),h.jc("disabled",o.forma.invalid))},directives:[a.u,a.T,a.i,a.e,a.f,a.R,a.p,A.a,e.r,e.l,e.f,a.z,a.d,i.k,n.c,n.g,c.b,e.a,e.k,e.d,n.f,a.K,n.b,d.b],styles:[".mt-32[_ngcontent-%COMP%]{margin-top:32px}.mt-24[_ngcontent-%COMP%]{margin-top:24px}.mt-80[_ngcontent-%COMP%]{margin-top:5em}.mt-40[_ngcontent-%COMP%]{margin-top:2.5em}.mt-36[_ngcontent-%COMP%]{margin-top:2.25em}.mt-52[_ngcontent-%COMP%]{margin-top:3.25em}.texto-1[_ngcontent-%COMP%]{font-size:1em;color:rgba(0,0,0,.87)}.button-registrarse[_ngcontent-%COMP%]{width:80%;margin-left:10%}"]}),t})();var S=s("j1ZV");let O=(()=>{class t{}return t.\u0275mod=h.Ob({type:t}),t.\u0275inj=h.Nb({factory:function(o){return new(o||t)},imports:[[i.c,e.g,e.o,a.U,n.e,l.b,c.c,d.c,m.b,S.a,r.j.forChild([{path:"",component:v}])]]}),t})()}}]);